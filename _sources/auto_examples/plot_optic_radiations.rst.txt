
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_optic_radiations.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_optic_radiations.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_optic_radiations.py:


=============================
Plotting the Optic Radiations
=============================

pyAFQ is designed to be customizable and extensible. This example shows how you
can customize it to define a new bundle based on a definition of waypoint and
endpoint ROIs of your design.

In this case, we add the optic radiations, based on work by Caffara et al. [1]_,
[2]_. The optic radiations (OR) are the primary projection of visual information
from the lateral geniculate nucleus of the thalamus to the primary visual
cortex. Studying the optic radiations with dMRI provides a linkage between white
matter tissue properties, visual perception and behavior, and physiological
responses of the visual cortex to visual stimulation.

We start by importing some of the components that we need for this example and
fixing the random seed for reproducibility

.. GENERATED FROM PYTHON SOURCE LINES 21-35

.. code-block:: default


    import os.path as op
    import plotly
    import numpy as np
    import shutil

    from AFQ.api.group import GroupAFQ
    import AFQ.api.bundle_dict as abd
    import AFQ.data.fetch as afd
    from AFQ.definitions.image import ImageFile, RoiImage
    import AFQ.utils.streamlines as aus
    np.random.seed(1234)









.. GENERATED FROM PYTHON SOURCE LINES 36-43

Get dMRI data
---------------
We will analyze one subject from the Healthy Brain Network Processed Open
Diffusion Derivatives dataset (HBN-POD2) [3]_, [4]_. We'll use a fetcher to
get preprocessed dMRI data for one of the >2,000 subjects in that study. The
data gets organized into a BIDS-compatible format in the `~/AFQ_data/HBN`
folder:

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default


    study_dir = afd.fetch_hbn_preproc(["NDARAA948VFH"])[1]





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   3%|2         | 1/36 [00:00<00:04,  7.21it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   3%|2         | 1/36 [00:00<00:04,  7.21it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   6%|5         | 2/36 [00:00<00:18,  1.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_dseg.nii.gz:   6%|5         | 2/36 [00:00<00:18,  1.82it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:   8%|8         | 3/36 [00:01<00:18,  1.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:  11%|#1        | 4/36 [00:01<00:14,  2.15it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  11%|#1        | 4/36 [00:01<00:14,  2.15it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  14%|#3        | 5/36 [00:02<00:13,  2.23it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  14%|#3        | 5/36 [00:02<00:13,  2.23it/s]                             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  17%|#6        | 6/36 [00:02<00:11,  2.59it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  17%|#6        | 6/36 [00:02<00:11,  2.59it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  19%|#9        | 7/36 [00:02<00:10,  2.76it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  19%|#9        | 7/36 [00:02<00:10,  2.76it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  22%|##2       | 8/36 [00:02<00:08,  3.31it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-brain_mask.nii.gz:  22%|##2       | 8/36 [00:02<00:08,  3.31it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  25%|##5       | 9/36 [00:03<00:08,  3.31it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  28%|##7       | 10/36 [00:03<00:06,  4.28it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_dseg.nii.gz:  28%|##7       | 10/36 [00:03<00:06,  4.28it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_dseg.nii.gz:  31%|###       | 11/36 [00:03<00:05,  4.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  31%|###       | 11/36 [00:03<00:05,  4.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  33%|###3      | 12/36 [00:03<00:05,  4.78it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  33%|###3      | 12/36 [00:03<00:05,  4.78it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  36%|###6      | 13/36 [00:03<00:04,  4.63it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  36%|###6      | 13/36 [00:03<00:04,  4.63it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  39%|###8      | 14/36 [00:04<00:05,  4.11it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  39%|###8      | 14/36 [00:04<00:05,  4.11it/s]                                 Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  42%|####1     | 15/36 [00:04<00:04,  4.55it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_carpetplot.svg:  42%|####1     | 15/36 [00:04<00:04,  4.55it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  44%|####4     | 16/36 [00:04<00:04,  4.55it/s]         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  47%|####7     | 17/36 [00:04<00:02,  6.40it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-resampled_b0ref.svg:  47%|####7     | 17/36 [00:04<00:02,  6.40it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-resampled_b0ref.svg:  50%|#####     | 18/36 [00:04<00:02,  6.83it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  50%|#####     | 18/36 [00:04<00:02,  6.83it/s]             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  53%|#####2    | 19/36 [00:04<00:02,  7.13it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_biascorr.svg:  53%|#####2    | 19/36 [00:04<00:02,  7.13it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_biascorr.svg:  56%|#####5    | 20/36 [00:04<00:02,  5.97it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  56%|#####5    | 20/36 [00:04<00:02,  5.97it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  58%|#####8    | 21/36 [00:05<00:03,  4.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  58%|#####8    | 21/36 [00:05<00:03,  4.82it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  61%|######1   | 22/36 [00:05<00:03,  4.56it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  61%|######1   | 22/36 [00:05<00:03,  4.56it/s]                                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  64%|######3   | 23/36 [00:05<00:02,  4.62it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_t1_2_mni.svg:  64%|######3   | 23/36 [00:05<00:02,  4.62it/s]                                   Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  67%|######6   | 24/36 [00:05<00:02,  4.62it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  69%|######9   | 25/36 [00:05<00:01,  6.30it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_confounds.tsv:  69%|######9   | 25/36 [00:05<00:01,  6.30it/s]                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  72%|#######2  | 26/36 [00:05<00:01,  6.30it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  75%|#######5  | 27/36 [00:06<00:01,  8.27it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-SliceQC_dwi.json:  75%|#######5  | 27/36 [00:06<00:01,  8.27it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  78%|#######7  | 28/36 [00:06<00:00,  8.27it/s]               Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  81%|########  | 29/36 [00:06<00:00,  7.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz:  81%|########  | 29/36 [00:06<00:00,  7.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-eddy_cnr.nii.gz:  83%|########3 | 30/36 [00:06<00:00,  7.02it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-eddy_cnr.nii.gz:  86%|########6 | 31/36 [00:06<00:00,  8.57it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.b:  86%|########6 | 31/36 [00:06<00:00,  8.57it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval:  89%|########8 | 32/36 [00:06<00:00,  8.57it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval:  92%|#########1| 33/36 [00:06<00:00, 10.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec:  92%|#########1| 33/36 [00:06<00:00, 10.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  94%|#########4| 34/36 [00:06<00:00, 10.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  97%|#########7| 35/36 [00:08<00:00,  3.16it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz:  97%|#########7| 35/36 [00:08<00:00,  3.16it/s]              Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz: 100%|##########| 36/36 [00:08<00:00,  3.33it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz: 100%|##########| 36/36 [00:08<00:00,  4.28it/s]




.. GENERATED FROM PYTHON SOURCE LINES 47-57

Define custom `BundleDict` object
--------------------------------
The `BundleDict` object holds information about "include" and "exclude" ROIs,
as well as endpoint ROIS, and whether the bundle crosses the midline. In this
case, the ROIs are all defined in the MNI template space that is used as the
default template space in pyAFQ, but, in principle, other template spaces
could be used.

The ROIs for the case can be downloaded using a custom fetcher and then read
into a dict as follows:

.. GENERATED FROM PYTHON SOURCE LINES 57-88

.. code-block:: default


    or_rois = afd.read_or_templates()

    bundles = abd.BundleDict({
        "L_OR": {
            "include": [
                or_rois["left_OR_1"],
                or_rois["left_OR_2"]],
            "exclude": [
                or_rois["left_OP_MNI"],
                or_rois["left_TP_MNI"],
                or_rois["left_pos_thal_MNI"]],
            "start": or_rois['left_thal_MNI'],
            "end": or_rois['left_V1_MNI'],
            "cross_midline": False,
        },
        "R_OR": {
            "include": [
                or_rois["right_OR_1"],
                or_rois["right_OR_2"]],
            "exclude": [
                or_rois["right_OP_MNI"],
                or_rois["right_TP_MNI"],
                or_rois["right_pos_thal_MNI"]],
            "start": or_rois['right_thal_MNI'],
            "end": or_rois['right_V1_MNI'],
            "cross_midline": False
        }
    })






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4733.98 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2371.00 MB/s]
      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4785.29 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 1683.11 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2716.52 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 28.11 MB/s]     89%|########9 | 17/19 [00:00<00:00, 65.92 MB/s]    100%|##########| 19/19 [00:00<00:00, 65.85 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     16%|#5        | 3/19 [00:00<00:00, 21.30 MB/s]     84%|########4 | 16/19 [00:00<00:00, 62.76 MB/s]    100%|##########| 19/19 [00:00<00:00, 66.97 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2416.07 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2388.56 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2707.75 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 28.24 MB/s]     47%|####7     | 9/19 [00:00<00:00, 32.35 MB/s]    100%|##########| 19/19 [00:00<00:00, 66.68 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 28.25 MB/s]     79%|#######8  | 15/19 [00:00<00:00, 57.28 MB/s]    100%|##########| 19/19 [00:00<00:00, 66.83 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2437.13 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2347.12 MB/s]
    Downloading https://templateflow.s3.amazonaws.com/tpl-MNI152NLin2009cAsym/tpl-MNI152NLin2009cAsym_res-01_T2w.nii.gz
      0%|          | 0.00/13.3M [00:00<?, ?B/s]     51%|#####1    | 6.83M/13.3M [00:00<00:00, 68.3MB/s]    100%|##########| 13.3M/13.3M [00:00<00:00, 77.7MB/s]




.. GENERATED FROM PYTHON SOURCE LINES 89-96

Custom bundle definitions such as the OR, and the standard BundleDict can be
combined through addition. To get both the OR and the standard bundles, we
would execute the following code::

    bundles = bundles + abd.BundleDict()

In this case, we will skip this and generate just the OR.

.. GENERATED FROM PYTHON SOURCE LINES 99-114

Define GroupAFQ object
----------------------
HBN POD2 have been processed with qsiprep [5]_. This means that a brain mask
has already been computer for them. As you can see in other examples, these
data also have a mapping calculated for them, which can also be incorporated
into processing. However, in this case, we will let pyAFQ calculate its own
SyN-based mapping so that the `combine_bundle` method can be used below to
create a montage visualization.

For tractography, we use CSD-based probabilistic tractography seeding
extensively (`n_seeds=4` means 81 seeds per voxel!), but only within the ROIs
and not throughout the white matter. This is controlled by passing
`"seed_mask": RoiImage()` in the `tracking_params` dict. The custom bundles
are passed as `bundle_info=bundles`. The call to `my_afq.export_all()`
initiates the pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 114-134

.. code-block:: default


    brain_mask_definition = ImageFile(
        suffix="mask",
        filters={'desc': 'brain',
                 'space': 'T1w',
                 'scope': 'qsiprep'})

    my_afq = GroupAFQ(
        bids_path=study_dir,
        preproc_pipeline="qsiprep",
        output_dir=op.join(study_dir, "derivatives", "afq_or"),
        brain_mask_definition=brain_mask_definition,
        tracking_params={"n_seeds": 4,
                         "directions": "prob",
                         "odf_model": "CSD",
                         "seed_mask": RoiImage()},
        bundle_info=bundles)

    my_afq.export_all()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/bids/layout/validation.py:156: UserWarning:

    The PipelineDescription field was superseded by GeneratedBy in BIDS 1.4.0. You can use ``pybids upgrade`` to update your derivative dataset.

      0%|          | 0/234119.0 [00:00<?, ?it/s]      0%|          | 84/234119.0 [00:00<04:38, 839.55it/s]      0%|          | 483/234119.0 [00:00<01:26, 2688.49it/s]      0%|          | 874/234119.0 [00:00<01:11, 3242.86it/s]      1%|          | 1282/234119.0 [00:00<01:05, 3571.01it/s]      1%|          | 1675/234119.0 [00:00<01:02, 3697.13it/s]      1%|          | 2077/234119.0 [00:00<01:01, 3803.57it/s]      1%|1         | 2473/234119.0 [00:00<01:00, 3854.17it/s]      1%|1         | 2887/234119.0 [00:00<00:58, 3943.85it/s]      1%|1         | 3298/234119.0 [00:00<00:57, 3992.97it/s]      2%|1         | 3703/234119.0 [00:01<00:57, 4007.59it/s]      2%|1         | 4113/234119.0 [00:01<00:57, 4034.89it/s]      2%|1         | 4517/234119.0 [00:01<00:57, 4011.80it/s]      2%|2         | 4919/234119.0 [00:01<00:57, 3997.16it/s]      2%|2         | 5323/234119.0 [00:01<00:57, 4007.67it/s]      2%|2         | 5724/234119.0 [00:01<00:57, 3999.37it/s]      3%|2         | 6124/234119.0 [00:01<00:57, 3996.84it/s]      3%|2         | 6525/234119.0 [00:01<00:56, 3999.55it/s]      3%|2         | 6932/234119.0 [00:01<00:56, 4019.96it/s]      3%|3         | 7349/234119.0 [00:01<00:55, 4064.52it/s]      3%|3         | 7762/234119.0 [00:02<00:55, 4081.33it/s]      3%|3         | 8171/234119.0 [00:02<00:55, 4083.08it/s]      4%|3         | 8600/234119.0 [00:02<00:54, 4142.81it/s]      4%|3         | 9027/234119.0 [00:02<00:53, 4180.74it/s]      4%|4         | 9446/234119.0 [00:02<00:54, 4158.47it/s]      4%|4         | 9862/234119.0 [00:02<00:54, 4147.95it/s]      4%|4         | 10277/234119.0 [00:02<00:54, 4126.53it/s]      5%|4         | 10706/234119.0 [00:02<00:53, 4174.29it/s]      5%|4         | 11129/234119.0 [00:02<00:53, 4189.54it/s]      5%|4         | 11554/234119.0 [00:02<00:52, 4207.45it/s]      5%|5         | 11984/234119.0 [00:03<00:52, 4234.49it/s]      5%|5         | 12408/234119.0 [00:03<00:52, 4197.25it/s]      5%|5         | 12848/234119.0 [00:03<00:51, 4255.31it/s]      6%|5         | 13280/234119.0 [00:03<00:51, 4272.24it/s]      6%|5         | 13708/234119.0 [00:03<00:51, 4248.37it/s]      6%|6         | 14144/234119.0 [00:03<00:51, 4278.51it/s]      6%|6         | 14579/234119.0 [00:03<00:51, 4298.75it/s]      6%|6         | 15009/234119.0 [00:03<00:51, 4269.40it/s]      7%|6         | 15444/234119.0 [00:03<00:50, 4292.24it/s]      7%|6         | 15888/234119.0 [00:03<00:50, 4335.22it/s]      7%|6         | 16322/234119.0 [00:04<00:50, 4335.78it/s]      7%|7         | 16760/234119.0 [00:04<00:50, 4346.10it/s]      7%|7         | 17207/234119.0 [00:04<00:49, 4382.57it/s]      8%|7         | 17646/234119.0 [00:04<00:50, 4303.93it/s]      8%|7         | 18091/234119.0 [00:04<00:49, 4345.25it/s]      8%|7         | 18526/234119.0 [00:04<00:49, 4337.93it/s]      8%|8         | 18961/234119.0 [00:04<00:49, 4336.98it/s]      8%|8         | 19396/234119.0 [00:04<00:49, 4339.51it/s]      8%|8         | 19838/234119.0 [00:04<00:49, 4360.08it/s]      9%|8         | 20275/234119.0 [00:04<00:49, 4289.20it/s]      9%|8         | 20721/234119.0 [00:05<00:49, 4337.11it/s]      9%|9         | 21162/234119.0 [00:05<00:48, 4356.86it/s]      9%|9         | 21598/234119.0 [00:05<00:48, 4353.52it/s]      9%|9         | 22041/234119.0 [00:05<00:48, 4374.56it/s]     10%|9         | 22480/234119.0 [00:05<00:48, 4378.99it/s]     10%|9         | 22918/234119.0 [00:05<00:48, 4342.17it/s]     10%|9         | 23353/234119.0 [00:05<00:49, 4275.24it/s]     10%|#         | 23798/234119.0 [00:05<00:48, 4324.03it/s]     10%|#         | 24242/234119.0 [00:05<00:48, 4357.63it/s]     11%|#         | 24695/234119.0 [00:05<00:47, 4406.69it/s]     11%|#         | 25136/234119.0 [00:06<00:47, 4403.90it/s]     11%|#         | 25577/234119.0 [00:06<00:47, 4389.38it/s]     11%|#1        | 26032/234119.0 [00:06<00:46, 4436.95it/s]     11%|#1        | 26476/234119.0 [00:06<00:47, 4411.36it/s]     11%|#1        | 26918/234119.0 [00:06<00:47, 4386.99it/s]     12%|#1        | 27357/234119.0 [00:06<00:47, 4375.10it/s]     12%|#1        | 27806/234119.0 [00:06<00:46, 4408.56it/s]     12%|#2        | 28267/234119.0 [00:06<00:46, 4467.27it/s]     12%|#2        | 28714/234119.0 [00:06<00:46, 4432.21it/s]     12%|#2        | 29167/234119.0 [00:06<00:45, 4459.05it/s]     13%|#2        | 29616/234119.0 [00:07<00:45, 4465.68it/s]     13%|#2        | 30063/234119.0 [00:07<00:46, 4405.07it/s]     13%|#3        | 30504/234119.0 [00:07<00:46, 4355.98it/s]     13%|#3        | 30942/234119.0 [00:07<00:46, 4362.25it/s]     13%|#3        | 31408/234119.0 [00:07<00:45, 4447.88it/s]     14%|#3        | 31858/234119.0 [00:07<00:45, 4459.91it/s]     14%|#3        | 32305/234119.0 [00:07<00:45, 4453.55it/s]     14%|#3        | 32756/234119.0 [00:07<00:45, 4469.52it/s]     14%|#4        | 33204/234119.0 [00:07<00:45, 4449.65it/s]     14%|#4        | 33650/234119.0 [00:07<00:45, 4414.98it/s]     15%|#4        | 34095/234119.0 [00:08<00:45, 4425.04it/s]     15%|#4        | 34538/234119.0 [00:08<00:45, 4410.05it/s]     15%|#4        | 34999/234119.0 [00:08<00:44, 4468.71it/s]     15%|#5        | 35460/234119.0 [00:08<00:44, 4508.19it/s]     15%|#5        | 35911/234119.0 [00:08<00:44, 4480.64it/s]     16%|#5        | 36362/234119.0 [00:08<00:44, 4486.37it/s]     16%|#5        | 36817/234119.0 [00:08<00:43, 4503.87it/s]     16%|#5        | 37268/234119.0 [00:08<00:43, 4474.05it/s]     16%|#6        | 37716/234119.0 [00:08<00:44, 4444.03it/s]     16%|#6        | 38161/234119.0 [00:08<00:44, 4445.38it/s]     16%|#6        | 38606/234119.0 [00:09<00:43, 4444.71it/s]     17%|#6        | 39051/234119.0 [00:09<01:48, 1804.22it/s]     17%|#6        | 39489/234119.0 [00:09<01:29, 2183.64it/s]     17%|#7        | 39942/234119.0 [00:09<01:14, 2591.80it/s]     17%|#7        | 40397/234119.0 [00:09<01:04, 2981.33it/s]     17%|#7        | 40837/234119.0 [00:10<00:58, 3293.96it/s]     18%|#7        | 41273/234119.0 [00:10<00:54, 3548.46it/s]     18%|#7        | 41714/234119.0 [00:10<00:51, 3767.14it/s]     18%|#8        | 42168/234119.0 [00:10<00:48, 3973.26it/s]     18%|#8        | 42620/234119.0 [00:10<00:46, 4123.64it/s]     18%|#8        | 43069/234119.0 [00:10<00:45, 4223.49it/s]     19%|#8        | 43512/234119.0 [00:10<00:44, 4272.31it/s]     19%|#8        | 43974/234119.0 [00:10<00:43, 4372.19it/s]     19%|#8        | 44432/234119.0 [00:10<00:42, 4430.51it/s]     19%|#9        | 44883/234119.0 [00:10<00:43, 4381.75it/s]     19%|#9        | 45332/234119.0 [00:11<00:42, 4411.37it/s]     20%|#9        | 45777/234119.0 [00:11<00:42, 4404.58it/s]     20%|#9        | 46221/234119.0 [00:11<00:42, 4388.04it/s]     20%|#9        | 46662/234119.0 [00:11<00:42, 4376.54it/s]     20%|##        | 47113/234119.0 [00:11<00:42, 4416.04it/s]     20%|##        | 47565/234119.0 [00:11<00:41, 4445.10it/s]     21%|##        | 48020/234119.0 [00:11<00:41, 4476.04it/s]     21%|##        | 48472/234119.0 [00:11<00:41, 4488.64it/s]     21%|##        | 48922/234119.0 [00:11<00:41, 4440.72it/s]     21%|##1       | 49367/234119.0 [00:11<00:41, 4436.94it/s]     21%|##1       | 49816/234119.0 [00:12<00:41, 4452.08it/s]     21%|##1       | 50262/234119.0 [00:12<00:41, 4436.65it/s]     22%|##1       | 50711/234119.0 [00:12<00:41, 4451.13it/s]     22%|##1       | 51166/234119.0 [00:12<00:40, 4478.24it/s]     22%|##2       | 51617/234119.0 [00:12<00:40, 4487.36it/s]     22%|##2       | 52086/234119.0 [00:12<00:40, 4543.71it/s]     22%|##2       | 52541/234119.0 [00:12<00:40, 4535.31it/s]     23%|##2       | 52995/234119.0 [00:12<00:40, 4516.90it/s]     23%|##2       | 53447/234119.0 [00:12<00:40, 4494.47it/s]     23%|##3       | 53897/234119.0 [00:12<00:40, 4445.84it/s]     23%|##3       | 54355/234119.0 [00:13<00:40, 4481.96it/s]     23%|##3       | 54813/234119.0 [00:13<00:39, 4510.71it/s]     24%|##3       | 55272/234119.0 [00:13<00:39, 4534.16it/s]     24%|##3       | 55731/234119.0 [00:13<00:39, 4549.11it/s]     24%|##4       | 56193/234119.0 [00:13<00:38, 4569.17it/s]     24%|##4       | 56651/234119.0 [00:13<00:38, 4571.39it/s]     24%|##4       | 57109/234119.0 [00:13<00:39, 4522.35it/s]     25%|##4       | 57562/234119.0 [00:13<00:39, 4452.07it/s]     25%|##4       | 58008/234119.0 [00:13<00:39, 4426.89it/s]     25%|##4       | 58459/234119.0 [00:14<00:39, 4449.94it/s]     25%|##5       | 58917/234119.0 [00:14<00:39, 4485.84it/s]     25%|##5       | 59379/234119.0 [00:14<00:38, 4523.66it/s]     26%|##5       | 59839/234119.0 [00:14<00:38, 4545.23it/s]     26%|##5       | 60301/234119.0 [00:14<00:38, 4566.24it/s]     26%|##5       | 60758/234119.0 [00:14<00:38, 4550.18it/s]     26%|##6       | 61214/234119.0 [00:14<00:38, 4492.27it/s]     26%|##6       | 61664/234119.0 [00:14<00:39, 4392.91it/s]     27%|##6       | 62104/234119.0 [00:14<00:39, 4390.52it/s]     27%|##6       | 62546/234119.0 [00:14<00:39, 4397.78it/s]     27%|##6       | 63017/234119.0 [00:15<00:38, 4486.78it/s]     27%|##7       | 63480/234119.0 [00:15<00:37, 4525.26it/s]     27%|##7       | 63938/234119.0 [00:15<00:37, 4539.55it/s]     28%|##7       | 64398/234119.0 [00:15<00:37, 4554.81it/s]     28%|##7       | 64861/234119.0 [00:15<00:36, 4575.41it/s]     28%|##7       | 65319/234119.0 [00:15<00:36, 4568.80it/s]     28%|##8       | 65776/234119.0 [00:15<00:37, 4504.42it/s]     28%|##8       | 66227/234119.0 [00:15<00:37, 4471.66it/s]     28%|##8       | 66675/234119.0 [00:15<00:37, 4465.80it/s]     29%|##8       | 67141/234119.0 [00:15<00:36, 4522.00it/s]     29%|##8       | 67603/234119.0 [00:16<00:36, 4549.27it/s]     29%|##9       | 68059/234119.0 [00:16<00:36, 4551.50it/s]     29%|##9       | 68515/234119.0 [00:16<00:36, 4547.30it/s]     29%|##9       | 68983/234119.0 [00:16<00:36, 4584.94it/s]     30%|##9       | 69453/234119.0 [00:16<00:35, 4617.84it/s]     30%|##9       | 69915/234119.0 [00:16<00:36, 4528.05it/s]     30%|###       | 70369/234119.0 [00:16<00:36, 4472.38it/s]     30%|###       | 70824/234119.0 [00:16<00:36, 4492.61it/s]     30%|###       | 71277/234119.0 [00:16<00:36, 4503.32it/s]     31%|###       | 71739/234119.0 [00:16<00:35, 4537.48it/s]     31%|###       | 72193/234119.0 [00:17<00:35, 4505.35it/s]     31%|###1      | 72653/234119.0 [00:17<00:35, 4531.58it/s]     31%|###1      | 73118/234119.0 [00:17<00:35, 4565.61it/s]     31%|###1      | 73600/234119.0 [00:17<00:34, 4640.49it/s]     32%|###1      | 74065/234119.0 [00:17<00:34, 4633.39it/s]     32%|###1      | 74529/234119.0 [00:17<00:35, 4545.13it/s]     32%|###2      | 74984/234119.0 [00:17<00:35, 4529.47it/s]     32%|###2      | 75442/234119.0 [00:17<00:34, 4543.36it/s]     32%|###2      | 75899/234119.0 [00:17<00:34, 4549.20it/s]     33%|###2      | 76357/234119.0 [00:17<00:34, 4558.06it/s]     33%|###2      | 76822/234119.0 [00:18<00:34, 4582.42it/s]     33%|###3      | 77286/234119.0 [00:18<00:34, 4598.23it/s]     33%|###3      | 77746/234119.0 [00:18<00:34, 4577.75it/s]     33%|###3      | 78219/234119.0 [00:18<00:33, 4620.72it/s]     34%|###3      | 78682/234119.0 [00:18<00:33, 4575.50it/s]     34%|###3      | 79140/234119.0 [00:18<00:34, 4525.13it/s]     34%|###3      | 79600/234119.0 [00:18<00:33, 4545.99it/s]     34%|###4      | 80055/234119.0 [00:18<00:33, 4542.84it/s]     34%|###4      | 80511/234119.0 [00:18<00:33, 4547.60it/s]     35%|###4      | 80970/234119.0 [00:18<00:33, 4559.14it/s]     35%|###4      | 81426/234119.0 [00:19<00:33, 4542.78it/s]     35%|###4      | 81891/234119.0 [00:19<00:33, 4571.75it/s]     35%|###5      | 82349/234119.0 [00:19<00:33, 4561.35it/s]     35%|###5      | 82819/234119.0 [00:19<00:32, 4602.43it/s]     36%|###5      | 83280/234119.0 [00:19<00:33, 4529.91it/s]     36%|###5      | 83734/234119.0 [00:19<00:33, 4514.45it/s]     36%|###5      | 84193/234119.0 [00:19<00:33, 4534.44it/s]     36%|###6      | 84647/234119.0 [00:19<00:33, 4526.92it/s]     36%|###6      | 85104/234119.0 [00:19<00:32, 4539.15it/s]     37%|###6      | 85575/234119.0 [00:19<00:32, 4587.69it/s]     37%|###6      | 86049/234119.0 [00:20<00:31, 4629.84it/s]     37%|###6      | 86513/234119.0 [00:20<00:31, 4617.36it/s]     37%|###7      | 86975/234119.0 [00:20<00:31, 4605.47it/s]     37%|###7      | 87436/234119.0 [00:20<00:32, 4567.99it/s]     38%|###7      | 87893/234119.0 [00:20<00:32, 4520.53it/s]     38%|###7      | 88346/234119.0 [00:20<00:32, 4458.47it/s]     38%|###7      | 88793/234119.0 [00:20<00:32, 4448.15it/s]     38%|###8      | 89240/234119.0 [00:20<00:32, 4451.36it/s]     38%|###8      | 89689/234119.0 [00:20<00:32, 4462.73it/s]     39%|###8      | 90147/234119.0 [00:20<00:32, 4497.47it/s]     39%|###8      | 90615/234119.0 [00:21<00:31, 4549.69it/s]     39%|###8      | 91071/234119.0 [00:21<00:31, 4522.44it/s]     39%|###9      | 91534/234119.0 [00:21<00:31, 4551.74it/s]     39%|###9      | 91990/234119.0 [00:21<00:31, 4522.82it/s]     39%|###9      | 92443/234119.0 [00:21<00:31, 4498.59it/s]     40%|###9      | 92893/234119.0 [00:21<00:31, 4462.06it/s]     40%|###9      | 93340/234119.0 [00:21<00:31, 4449.11it/s]     40%|####      | 93790/234119.0 [00:21<00:31, 4461.80it/s]     40%|####      | 94248/234119.0 [00:21<00:31, 4492.90it/s]     40%|####      | 94698/234119.0 [00:22<00:31, 4479.98it/s]     41%|####      | 95152/234119.0 [00:22<00:30, 4497.34it/s]     41%|####      | 95602/234119.0 [00:22<00:30, 4475.50it/s]     41%|####1     | 96070/234119.0 [00:22<00:30, 4536.33it/s]     41%|####1     | 96524/234119.0 [00:22<00:30, 4448.05it/s]     41%|####1     | 96970/234119.0 [00:22<00:30, 4428.27it/s]     42%|####1     | 97421/234119.0 [00:22<00:30, 4451.52it/s]     42%|####1     | 97867/234119.0 [00:22<00:30, 4429.59it/s]     42%|####1     | 98323/234119.0 [00:22<00:30, 4465.77it/s]     42%|####2     | 98774/234119.0 [00:22<00:30, 4474.05it/s]     42%|####2     | 99235/234119.0 [00:23<00:29, 4512.28it/s]     43%|####2     | 99688/234119.0 [00:23<00:29, 4514.93it/s]     43%|####2     | 100146/234119.0 [00:23<00:29, 4531.82it/s]     43%|####2     | 100600/234119.0 [00:23<00:29, 4508.62it/s]     43%|####3     | 101051/234119.0 [00:23<00:29, 4448.21it/s]     43%|####3     | 101506/234119.0 [00:23<00:29, 4477.89it/s]     44%|####3     | 101963/234119.0 [00:23<00:29, 4503.51it/s]     44%|####3     | 102417/234119.0 [00:23<00:29, 4513.86it/s]     44%|####3     | 102869/234119.0 [00:23<00:29, 4511.04it/s]     44%|####4     | 103321/234119.0 [00:23<00:29, 4490.99it/s]     44%|####4     | 103783/234119.0 [00:24<00:28, 4526.78it/s]     45%|####4     | 104240/234119.0 [00:24<00:28, 4536.54it/s]     45%|####4     | 104701/234119.0 [00:24<00:28, 4556.15it/s]     45%|####4     | 105157/234119.0 [00:24<00:28, 4528.19it/s]     45%|####5     | 105610/234119.0 [00:24<00:28, 4500.19it/s]     45%|####5     | 106061/234119.0 [00:24<00:28, 4495.14it/s]     45%|####5     | 106523/234119.0 [00:24<00:28, 4530.03it/s]     46%|####5     | 106988/234119.0 [00:24<00:27, 4563.31it/s]     46%|####5     | 107463/234119.0 [00:24<00:27, 4617.25it/s]     46%|####6     | 107925/234119.0 [00:24<00:27, 4575.09it/s]     46%|####6     | 108388/234119.0 [00:25<00:27, 4589.85it/s]     46%|####6     | 108848/234119.0 [00:25<00:27, 4566.60it/s]     47%|####6     | 109305/234119.0 [00:25<00:27, 4532.20it/s]     47%|####6     | 109762/234119.0 [00:25<00:27, 4541.82it/s]     47%|####7     | 110232/234119.0 [00:25<00:27, 4586.98it/s]     47%|####7     | 110691/234119.0 [00:25<00:27, 4569.16it/s]     47%|####7     | 111148/234119.0 [00:25<00:27, 4549.93it/s]     48%|####7     | 111613/234119.0 [00:25<00:26, 4578.57it/s]     48%|####7     | 112071/234119.0 [00:25<00:26, 4565.75it/s]     48%|####8     | 112543/234119.0 [00:25<00:26, 4610.25it/s]     48%|####8     | 113005/234119.0 [00:26<00:26, 4556.21it/s]     48%|####8     | 113461/234119.0 [00:26<00:26, 4515.16it/s]     49%|####8     | 113913/234119.0 [00:26<00:26, 4494.72it/s]     49%|####8     | 114372/234119.0 [00:26<00:26, 4522.60it/s]     49%|####9     | 114825/234119.0 [00:26<00:26, 4512.93it/s]     49%|####9     | 115277/234119.0 [00:26<00:26, 4500.60it/s]     49%|####9     | 115742/234119.0 [00:26<00:26, 4543.83it/s]     50%|####9     | 116198/234119.0 [00:26<00:25, 4546.58it/s]     50%|####9     | 116659/234119.0 [00:26<00:25, 4563.85it/s]     50%|#####     | 117128/234119.0 [00:26<00:25, 4599.74it/s]     50%|#####     | 117589/234119.0 [00:27<00:25, 4582.88it/s]     50%|#####     | 118048/234119.0 [00:27<00:25, 4577.39it/s]     51%|#####     | 118509/234119.0 [00:27<00:25, 4584.94it/s]     51%|#####     | 118968/234119.0 [00:27<00:44, 2614.59it/s]     51%|#####1    | 119413/234119.0 [00:27<00:38, 2973.29it/s]     51%|#####1    | 119864/234119.0 [00:27<00:34, 3309.00it/s]     51%|#####1    | 120330/234119.0 [00:27<00:31, 3628.15it/s]     52%|#####1    | 120795/234119.0 [00:28<00:29, 3885.59it/s]     52%|#####1    | 121272/234119.0 [00:28<00:27, 4119.12it/s]     52%|#####1    | 121724/234119.0 [00:28<00:26, 4226.94it/s]     52%|#####2    | 122173/234119.0 [00:28<00:26, 4276.87it/s]     52%|#####2    | 122625/234119.0 [00:28<00:25, 4346.33it/s]     53%|#####2    | 123073/234119.0 [00:28<00:25, 4376.84it/s]     53%|#####2    | 123521/234119.0 [00:28<00:25, 4380.06it/s]     53%|#####2    | 123983/234119.0 [00:28<00:24, 4450.16it/s]     53%|#####3    | 124438/234119.0 [00:28<00:24, 4479.60it/s]     53%|#####3    | 124914/234119.0 [00:28<00:23, 4562.03it/s]     54%|#####3    | 125381/234119.0 [00:29<00:23, 4592.96it/s]     54%|#####3    | 125848/234119.0 [00:29<00:23, 4615.90it/s]     54%|#####3    | 126311/234119.0 [00:29<00:23, 4545.39it/s]     54%|#####4    | 126767/234119.0 [00:29<00:23, 4533.63it/s]     54%|#####4    | 127222/234119.0 [00:29<00:23, 4499.72it/s]     55%|#####4    | 127673/234119.0 [00:29<00:23, 4495.61it/s]     55%|#####4    | 128131/234119.0 [00:29<00:23, 4519.38it/s]     55%|#####4    | 128601/234119.0 [00:29<00:23, 4570.81it/s]     55%|#####5    | 129059/234119.0 [00:29<00:23, 4533.82it/s]     55%|#####5    | 129526/234119.0 [00:29<00:22, 4573.75it/s]     56%|#####5    | 129984/234119.0 [00:30<00:22, 4573.31it/s]     56%|#####5    | 130442/234119.0 [00:30<00:22, 4529.76it/s]     56%|#####5    | 130896/234119.0 [00:30<00:23, 4447.05it/s]     56%|#####6    | 131353/234119.0 [00:30<00:22, 4482.49it/s]     56%|#####6    | 131802/234119.0 [00:30<00:22, 4453.08it/s]     56%|#####6    | 132248/234119.0 [00:30<00:22, 4441.89it/s]     57%|#####6    | 132698/234119.0 [00:30<00:22, 4456.64it/s]     57%|#####6    | 133158/234119.0 [00:30<00:22, 4497.33it/s]     57%|#####7    | 133618/234119.0 [00:30<00:22, 4524.94it/s]     57%|#####7    | 134083/234119.0 [00:30<00:21, 4561.97it/s]     57%|#####7    | 134553/234119.0 [00:31<00:21, 4602.13it/s]     58%|#####7    | 135014/234119.0 [00:31<00:21, 4596.80it/s]     58%|#####7    | 135474/234119.0 [00:31<00:21, 4545.79it/s]     58%|#####8    | 135929/234119.0 [00:31<00:21, 4532.26it/s]     58%|#####8    | 136383/234119.0 [00:31<00:21, 4534.50it/s]     58%|#####8    | 136838/234119.0 [00:31<00:21, 4535.33it/s]     59%|#####8    | 137299/234119.0 [00:31<00:21, 4556.40it/s]     59%|#####8    | 137757/234119.0 [00:31<00:21, 4558.09it/s]     59%|#####9    | 138213/234119.0 [00:31<00:21, 4551.92it/s]     59%|#####9    | 138678/234119.0 [00:31<00:20, 4580.10it/s]     59%|#####9    | 139159/234119.0 [00:32<00:20, 4647.52it/s]     60%|#####9    | 139624/234119.0 [00:32<00:20, 4578.17it/s]     60%|#####9    | 140083/234119.0 [00:32<00:20, 4557.62it/s]     60%|######    | 140539/234119.0 [00:32<00:20, 4545.50it/s]     60%|######    | 140994/234119.0 [00:32<00:20, 4530.92it/s]     60%|######    | 141448/234119.0 [00:32<00:20, 4528.48it/s]     61%|######    | 141912/234119.0 [00:32<00:20, 4560.74it/s]     61%|######    | 142373/234119.0 [00:32<00:20, 4573.54it/s]     61%|######1   | 142838/234119.0 [00:32<00:19, 4596.06it/s]     61%|######1   | 143298/234119.0 [00:32<00:19, 4582.10it/s]     61%|######1   | 143760/234119.0 [00:33<00:19, 4591.51it/s]     62%|######1   | 144220/234119.0 [00:33<00:19, 4534.19it/s]     62%|######1   | 144674/234119.0 [00:33<00:19, 4486.26it/s]     62%|######1   | 145138/234119.0 [00:33<00:19, 4530.29it/s]     62%|######2   | 145593/234119.0 [00:33<00:19, 4533.11it/s]     62%|######2   | 146047/234119.0 [00:33<00:19, 4524.51it/s]     63%|######2   | 146510/234119.0 [00:33<00:19, 4555.81it/s]     63%|######2   | 146976/234119.0 [00:33<00:19, 4586.27it/s]     63%|######2   | 147448/234119.0 [00:33<00:18, 4623.65it/s]     63%|######3   | 147918/234119.0 [00:33<00:18, 4644.74it/s]     63%|######3   | 148383/234119.0 [00:34<00:18, 4602.48it/s]     64%|######3   | 148844/234119.0 [00:34<00:18, 4555.83it/s]     64%|######3   | 149300/234119.0 [00:34<00:18, 4485.10it/s]     64%|######3   | 149771/234119.0 [00:34<00:18, 4550.31it/s]     64%|######4   | 150227/234119.0 [00:34<00:18, 4537.98it/s]     64%|######4   | 150684/234119.0 [00:34<00:18, 4545.51it/s]     65%|######4   | 151142/234119.0 [00:34<00:18, 4553.66it/s]     65%|######4   | 151606/234119.0 [00:34<00:18, 4578.66it/s]     65%|######4   | 152066/234119.0 [00:34<00:17, 4583.16it/s]     65%|######5   | 152543/234119.0 [00:34<00:17, 4637.23it/s]     65%|######5   | 153007/234119.0 [00:35<00:17, 4561.47it/s]     66%|######5   | 153464/234119.0 [00:35<00:17, 4533.07it/s]     66%|######5   | 153930/234119.0 [00:35<00:17, 4566.07it/s]     66%|######5   | 154397/234119.0 [00:35<00:17, 4594.88it/s]     66%|######6   | 154857/234119.0 [00:35<00:17, 4569.36it/s]     66%|######6   | 155330/234119.0 [00:35<00:17, 4616.84it/s]     67%|######6   | 155800/234119.0 [00:35<00:16, 4639.89it/s]     67%|######6   | 156265/234119.0 [00:35<00:16, 4620.90it/s]     67%|######6   | 156728/234119.0 [00:35<00:16, 4607.40it/s]     67%|######7   | 157189/234119.0 [00:36<00:16, 4555.40it/s]     67%|######7   | 157645/234119.0 [00:36<00:16, 4514.66it/s]     68%|######7   | 158106/234119.0 [00:36<00:16, 4541.26it/s]     68%|######7   | 158572/234119.0 [00:36<00:16, 4573.92it/s]     68%|######7   | 159030/234119.0 [00:36<00:16, 4527.78it/s]     68%|######8   | 159493/234119.0 [00:36<00:16, 4556.73it/s]     68%|######8   | 159953/234119.0 [00:36<00:16, 4567.54it/s]     69%|######8   | 160410/234119.0 [00:36<00:16, 4546.75it/s]     69%|######8   | 160877/234119.0 [00:36<00:15, 4582.30it/s]     69%|######8   | 161341/234119.0 [00:36<00:15, 4598.15it/s]     69%|######9   | 161801/234119.0 [00:37<00:15, 4572.14it/s]     69%|######9   | 162259/234119.0 [00:37<00:15, 4528.10it/s]     69%|######9   | 162712/234119.0 [00:37<00:15, 4522.91it/s]     70%|######9   | 163165/234119.0 [00:37<00:15, 4519.82it/s]     70%|######9   | 163622/234119.0 [00:37<00:15, 4533.61it/s]     70%|#######   | 164087/234119.0 [00:37<00:15, 4564.78it/s]     70%|#######   | 164547/234119.0 [00:37<00:15, 4573.99it/s]     70%|#######   | 165011/234119.0 [00:37<00:15, 4591.84it/s]     71%|#######   | 165481/234119.0 [00:37<00:14, 4622.94it/s]     71%|#######   | 165944/234119.0 [00:37<00:14, 4591.17it/s]     71%|#######1  | 166404/234119.0 [00:38<00:14, 4525.39it/s]     71%|#######1  | 166857/234119.0 [00:38<00:14, 4503.36it/s]     71%|#######1  | 167321/234119.0 [00:38<00:14, 4541.55it/s]     72%|#######1  | 167790/234119.0 [00:38<00:14, 4582.64it/s]     72%|#######1  | 168249/234119.0 [00:38<00:14, 4576.91it/s]     72%|#######2  | 168707/234119.0 [00:38<00:14, 4574.23it/s]     72%|#######2  | 169171/234119.0 [00:38<00:14, 4591.67it/s]     72%|#######2  | 169644/234119.0 [00:38<00:13, 4630.45it/s]     73%|#######2  | 170114/234119.0 [00:38<00:13, 4648.91it/s]     73%|#######2  | 170579/234119.0 [00:38<00:13, 4598.12it/s]     73%|#######3  | 171039/234119.0 [00:39<00:13, 4574.09it/s]     73%|#######3  | 171497/234119.0 [00:39<00:13, 4566.45it/s]     73%|#######3  | 171955/234119.0 [00:39<00:13, 4569.32it/s]     74%|#######3  | 172420/234119.0 [00:39<00:13, 4590.02it/s]     74%|#######3  | 172884/234119.0 [00:39<00:13, 4602.64it/s]     74%|#######4  | 173352/234119.0 [00:39<00:13, 4623.59it/s]     74%|#######4  | 173825/234119.0 [00:39<00:12, 4653.80it/s]     74%|#######4  | 174298/234119.0 [00:39<00:12, 4675.88it/s]     75%|#######4  | 174766/234119.0 [00:39<00:12, 4572.35it/s]     75%|#######4  | 175224/234119.0 [00:39<00:13, 4518.29it/s]     75%|#######5  | 175686/234119.0 [00:40<00:12, 4546.62it/s]     75%|#######5  | 176142/234119.0 [00:40<00:12, 4529.11it/s]     75%|#######5  | 176606/234119.0 [00:40<00:12, 4558.88it/s]     76%|#######5  | 177063/234119.0 [00:40<00:12, 4561.38it/s]     76%|#######5  | 177527/234119.0 [00:40<00:12, 4584.14it/s]     76%|#######6  | 177986/234119.0 [00:40<00:12, 4582.35it/s]     76%|#######6  | 178445/234119.0 [00:40<00:12, 4566.81it/s]     76%|#######6  | 178902/234119.0 [00:40<00:12, 4521.65it/s]     77%|#######6  | 179356/234119.0 [00:40<00:12, 4526.11it/s]     77%|#######6  | 179811/234119.0 [00:40<00:11, 4531.47it/s]     77%|#######6  | 180265/234119.0 [00:41<00:11, 4532.68it/s]     77%|#######7  | 180728/234119.0 [00:41<00:11, 4561.20it/s]     77%|#######7  | 181192/234119.0 [00:41<00:11, 4583.89it/s]     78%|#######7  | 181660/234119.0 [00:41<00:11, 4610.71it/s]     78%|#######7  | 182127/234119.0 [00:41<00:11, 4625.51it/s]     78%|#######7  | 182590/234119.0 [00:41<00:11, 4593.47it/s]     78%|#######8  | 183050/234119.0 [00:41<00:11, 4550.01it/s]     78%|#######8  | 183506/234119.0 [00:41<00:11, 4531.80it/s]     79%|#######8  | 183960/234119.0 [00:41<00:11, 4523.21it/s]     79%|#######8  | 184413/234119.0 [00:41<00:11, 4500.43it/s]     79%|#######8  | 184865/234119.0 [00:42<00:10, 4504.91it/s]     79%|#######9  | 185324/234119.0 [00:42<00:10, 4530.02it/s]     79%|#######9  | 185778/234119.0 [00:42<00:10, 4504.77it/s]     80%|#######9  | 186229/234119.0 [00:42<00:10, 4486.99it/s]     80%|#######9  | 186683/234119.0 [00:42<00:10, 4500.66it/s]     80%|#######9  | 187134/234119.0 [00:42<00:10, 4441.86it/s]     80%|########  | 187590/234119.0 [00:42<00:10, 4473.53it/s]     80%|########  | 188044/234119.0 [00:42<00:10, 4492.58it/s]     81%|########  | 188494/234119.0 [00:42<00:10, 4467.50it/s]     81%|########  | 188946/234119.0 [00:42<00:10, 4478.82it/s]     81%|########  | 189414/234119.0 [00:43<00:09, 4534.55it/s]     81%|########1 | 189868/234119.0 [00:43<00:09, 4510.06it/s]     81%|########1 | 190320/234119.0 [00:43<00:09, 4479.15it/s]     81%|########1 | 190769/234119.0 [00:43<00:09, 4474.84it/s]     82%|########1 | 191217/234119.0 [00:43<00:09, 4467.10it/s]     82%|########1 | 191664/234119.0 [00:43<00:09, 4442.97it/s]     82%|########2 | 192118/234119.0 [00:43<00:09, 4471.68it/s]     82%|########2 | 192570/234119.0 [00:43<00:09, 4484.55it/s]     82%|########2 | 193028/234119.0 [00:43<00:09, 4512.35it/s]     83%|########2 | 193481/234119.0 [00:43<00:08, 4516.38it/s]     83%|########2 | 193935/234119.0 [00:44<00:08, 4520.76it/s]     83%|########3 | 194389/234119.0 [00:44<00:08, 4524.84it/s]     83%|########3 | 194842/234119.0 [00:44<00:08, 4484.26it/s]     83%|########3 | 195298/234119.0 [00:44<00:08, 4505.24it/s]     84%|########3 | 195749/234119.0 [00:44<00:08, 4476.83it/s]     84%|########3 | 196201/234119.0 [00:44<00:08, 4485.89it/s]     84%|########3 | 196650/234119.0 [00:44<00:08, 4485.29it/s]     84%|########4 | 197099/234119.0 [00:44<00:08, 4475.22it/s]     84%|########4 | 197553/234119.0 [00:44<00:08, 4494.13it/s]     85%|########4 | 198003/234119.0 [00:44<00:08, 4495.45it/s]     85%|########4 | 198453/234119.0 [00:45<00:08, 4420.19it/s]     85%|########4 | 198897/234119.0 [00:45<00:07, 4423.46it/s]     85%|########5 | 199342/234119.0 [00:45<00:07, 4427.60it/s]     85%|########5 | 199797/234119.0 [00:45<00:07, 4462.90it/s]     86%|########5 | 200248/234119.0 [00:45<00:07, 4476.94it/s]     86%|########5 | 200699/234119.0 [00:45<00:07, 4485.11it/s]     86%|########5 | 201156/234119.0 [00:45<00:07, 4507.66it/s]     86%|########6 | 201607/234119.0 [00:45<00:07, 4498.30it/s]     86%|########6 | 202057/234119.0 [00:45<00:07, 4471.66it/s]     86%|########6 | 202505/234119.0 [00:46<00:07, 4450.09it/s]     87%|########6 | 202959/234119.0 [00:46<00:06, 4475.88it/s]     87%|########6 | 203412/234119.0 [00:46<00:06, 4491.10it/s]     87%|########7 | 203869/234119.0 [00:46<00:06, 4514.47it/s]     87%|########7 | 204321/234119.0 [00:46<00:06, 4507.20it/s]     87%|########7 | 204779/234119.0 [00:46<00:06, 4526.06it/s]     88%|########7 | 205232/234119.0 [00:46<00:06, 4515.41it/s]     88%|########7 | 205684/234119.0 [00:46<00:06, 4458.40it/s]     88%|########8 | 206142/234119.0 [00:46<00:06, 4493.89it/s]     88%|########8 | 206602/234119.0 [00:46<00:06, 4522.26it/s]     88%|########8 | 207058/234119.0 [00:47<00:05, 4533.03it/s]     89%|########8 | 207513/234119.0 [00:47<00:05, 4536.69it/s]     89%|########8 | 207971/234119.0 [00:47<00:05, 4548.19it/s]     89%|########9 | 208426/234119.0 [00:47<00:05, 4522.95it/s]     89%|########9 | 208879/234119.0 [00:47<00:05, 4461.72it/s]     89%|########9 | 209326/234119.0 [00:47<00:05, 4445.99it/s]     90%|########9 | 209788/234119.0 [00:47<00:05, 4496.19it/s]     90%|########9 | 210240/234119.0 [00:47<00:05, 4501.25it/s]     90%|########9 | 210696/234119.0 [00:47<00:05, 4516.04it/s]     90%|######### | 211148/234119.0 [00:47<00:05, 4509.35it/s]     90%|######### | 211599/234119.0 [00:48<00:04, 4506.51it/s]     91%|######### | 212050/234119.0 [00:48<00:04, 4437.81it/s]     91%|######### | 212504/234119.0 [00:48<00:04, 4466.36it/s]     91%|######### | 212961/234119.0 [00:48<00:04, 4494.73it/s]     91%|#########1| 213423/234119.0 [00:48<00:04, 4530.73it/s]     91%|#########1| 213877/234119.0 [00:48<00:04, 4518.80it/s]     92%|#########1| 214329/234119.0 [00:48<00:04, 4514.06it/s]     92%|#########1| 214781/234119.0 [00:48<00:04, 4492.45it/s]     92%|#########1| 215231/234119.0 [00:48<00:04, 4416.79it/s]     92%|#########2| 215688/234119.0 [00:48<00:04, 4461.74it/s]     92%|#########2| 216146/234119.0 [00:49<00:03, 4494.37it/s]     93%|#########2| 216596/234119.0 [00:49<00:03, 4488.75it/s]     93%|#########2| 217060/234119.0 [00:49<00:03, 4531.01it/s]     93%|#########2| 217514/234119.0 [00:49<00:03, 4490.61it/s]     93%|#########3| 217964/234119.0 [00:49<00:03, 4450.34it/s]     93%|#########3| 218428/234119.0 [00:49<00:03, 4502.32it/s]     93%|#########3| 218879/234119.0 [00:49<00:03, 4488.82it/s]     94%|#########3| 219329/234119.0 [00:49<00:03, 4401.76it/s]     94%|#########3| 219770/234119.0 [00:49<00:03, 4402.96it/s]     94%|#########4| 220211/234119.0 [00:50<00:05, 2466.32it/s]     94%|#########4| 220637/234119.0 [00:50<00:04, 2808.81it/s]     94%|#########4| 221096/234119.0 [00:50<00:04, 3189.33it/s]     95%|#########4| 221544/234119.0 [00:50<00:03, 3491.68it/s]     95%|#########4| 221983/234119.0 [00:50<00:03, 3716.87it/s]     95%|#########5| 222428/234119.0 [00:50<00:02, 3908.98it/s]     95%|#########5| 222868/234119.0 [00:50<00:02, 4043.12it/s]     95%|#########5| 223316/234119.0 [00:50<00:02, 4164.36it/s]     96%|#########5| 223762/234119.0 [00:51<00:02, 4248.43it/s]     96%|#########5| 224202/234119.0 [00:51<00:02, 4292.24it/s]     96%|#########5| 224654/234119.0 [00:51<00:02, 4356.14it/s]     96%|#########6| 225101/234119.0 [00:51<00:02, 4388.62it/s]     96%|#########6| 225545/234119.0 [00:51<00:01, 4361.66it/s]     97%|#########6| 225985/234119.0 [00:51<00:01, 4367.79it/s]     97%|#########6| 226425/234119.0 [00:51<00:01, 4354.34it/s]     97%|#########6| 226867/234119.0 [00:51<00:01, 4372.21it/s]     97%|#########7| 227312/234119.0 [00:51<00:01, 4394.67it/s]     97%|#########7| 227753/234119.0 [00:51<00:01, 4359.53it/s]     97%|#########7| 228190/234119.0 [00:52<00:01, 4343.78it/s]     98%|#########7| 228625/234119.0 [00:52<00:01, 4298.82it/s]     98%|#########7| 229063/234119.0 [00:52<00:01, 4321.55it/s]     98%|#########8| 229496/234119.0 [00:52<00:01, 4256.34it/s]     98%|#########8| 229940/234119.0 [00:52<00:00, 4306.72it/s]     98%|#########8| 230372/234119.0 [00:52<00:00, 4308.76it/s]     99%|#########8| 230805/234119.0 [00:52<00:00, 4313.85it/s]     99%|#########8| 231242/234119.0 [00:52<00:00, 4330.15it/s]     99%|#########8| 231676/234119.0 [00:52<00:00, 4328.68it/s]     99%|#########9| 232111/234119.0 [00:52<00:00, 4333.37it/s]     99%|#########9| 232545/234119.0 [00:53<00:00, 4305.19it/s]    100%|#########9| 233004/234119.0 [00:53<00:00, 4386.69it/s]    100%|#########9| 233447/234119.0 [00:53<00:00, 4397.68it/s]    100%|#########9| 233887/234119.0 [00:53<00:00, 4358.78it/s]    100%|##########| 234119/234119.0 [00:53<00:00, 4378.01it/s]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
      0%|          | 0/28280 [00:00<?, ?it/s]      0%|          | 2/28280 [00:00<32:35, 14.46it/s]      0%|          | 4/28280 [00:05<13:45:28,  1.75s/it]      0%|          | 14/28280 [00:06<2:42:28,  2.90it/s]      4%|3         | 1040/28280 [00:06<01:21, 334.28it/s]     15%|#4        | 4112/28280 [00:06<00:14, 1629.41it/s]     29%|##9       | 8208/28280 [00:06<00:05, 3635.74it/s]     36%|###6      | 10256/28280 [00:06<00:03, 4672.05it/s]     44%|####3     | 12304/28280 [00:06<00:02, 5784.25it/s]     51%|#####     | 14352/28280 [00:07<00:02, 6954.94it/s]     58%|#####7    | 16400/28280 [00:07<00:01, 8154.33it/s]     65%|######5   | 18448/28280 [00:07<00:01, 6481.21it/s]     72%|#######2  | 20496/28280 [00:08<00:02, 3740.87it/s]     80%|#######9  | 22544/28280 [00:10<00:02, 2430.66it/s]     87%|########6 | 24592/28280 [00:11<00:01, 1918.60it/s]     94%|#########4| 26640/28280 [00:13<00:01, 1554.52it/s]     95%|#########5| 26988/28280 [00:15<00:01, 1043.27it/s]     97%|#########6| 27336/28280 [00:15<00:00, 1058.60it/s]     98%|#########7| 27684/28280 [00:16<00:00, 946.97it/s]      99%|#########9| 28032/28280 [00:16<00:00, 975.83it/s]    100%|##########| 28280/28280 [00:16<00:00, 1676.62it/s]
      0%|          | 0/28280 [00:00<?, ?it/s]      0%|          | 20/28280 [00:00<02:23, 196.26it/s]      0%|          | 124/28280 [00:00<00:44, 630.37it/s]      2%|1         | 508/28280 [00:00<00:23, 1183.37it/s]      2%|2         | 636/28280 [00:00<00:24, 1110.63it/s]      3%|3         | 892/28280 [00:00<00:18, 1445.63it/s]      4%|3         | 1039/28280 [00:00<00:19, 1385.14it/s]      5%|5         | 1532/28280 [00:01<00:19, 1380.33it/s]      6%|6         | 1788/28280 [00:01<00:19, 1343.21it/s]      7%|7         | 2044/28280 [00:01<00:18, 1445.02it/s]      8%|8         | 2300/28280 [00:01<00:18, 1425.92it/s]     10%|9         | 2812/28280 [00:01<00:13, 1892.82it/s]     11%|#         | 3068/28280 [00:02<00:13, 1907.67it/s]     12%|#1        | 3324/28280 [00:02<00:13, 1818.27it/s]     13%|#2        | 3580/28280 [00:02<00:17, 1450.55it/s]     14%|#3        | 3836/28280 [00:02<00:19, 1236.15it/s]     14%|#4        | 4092/28280 [00:02<00:18, 1305.20it/s]     15%|#5        | 4348/28280 [00:03<00:17, 1356.99it/s]     16%|#6        | 4604/28280 [00:03<00:20, 1135.15it/s]     18%|#8        | 5116/28280 [00:03<00:17, 1346.90it/s]     19%|#8        | 5372/28280 [00:04<00:22, 998.82it/s]      20%|#9        | 5628/28280 [00:04<00:21, 1043.38it/s]     21%|##        | 5884/28280 [00:04<00:20, 1085.78it/s]     22%|##1       | 6140/28280 [00:04<00:22, 975.50it/s]      23%|##2       | 6396/28280 [00:05<00:26, 824.75it/s]     24%|##3       | 6652/28280 [00:05<00:23, 922.58it/s]     24%|##4       | 6908/28280 [00:05<00:19, 1111.69it/s]     25%|##5       | 7164/28280 [00:05<00:17, 1217.68it/s]     26%|##6       | 7420/28280 [00:06<00:19, 1044.72it/s]     27%|##7       | 7676/28280 [00:06<00:22, 924.69it/s]      28%|##8       | 7932/28280 [00:06<00:18, 1076.79it/s]     29%|##8       | 8188/28280 [00:06<00:16, 1201.72it/s]     30%|##9       | 8444/28280 [00:07<00:20, 976.95it/s]      31%|###       | 8700/28280 [00:07<00:22, 862.04it/s]     32%|###1      | 8956/28280 [00:07<00:21, 906.43it/s]     33%|###2      | 9212/28280 [00:08<00:22, 861.51it/s]     33%|###3      | 9468/28280 [00:08<00:20, 896.84it/s]     34%|###4      | 9724/28280 [00:08<00:18, 1002.79it/s]     35%|###5      | 9980/28280 [00:08<00:18, 1001.53it/s]     36%|###6      | 10236/28280 [00:09<00:21, 821.01it/s]     37%|###7      | 10492/28280 [00:09<00:19, 911.53it/s]     38%|###8      | 10748/28280 [00:09<00:19, 914.16it/s]     39%|###8      | 11004/28280 [00:09<00:15, 1122.76it/s]     40%|###9      | 11260/28280 [00:10<00:16, 1053.91it/s]     41%|####      | 11516/28280 [00:10<00:17, 980.62it/s]      42%|####1     | 11772/28280 [00:10<00:16, 1030.08it/s]     43%|####3     | 12284/28280 [00:11<00:14, 1097.18it/s]     44%|####4     | 12540/28280 [00:11<00:13, 1145.97it/s]     45%|####5     | 12796/28280 [00:11<00:13, 1180.09it/s]     46%|####6     | 13052/28280 [00:11<00:12, 1241.62it/s]     47%|####7     | 13308/28280 [00:11<00:10, 1410.64it/s]     48%|####7     | 13564/28280 [00:11<00:09, 1559.07it/s]     50%|####9     | 14076/28280 [00:12<00:06, 2082.87it/s]     54%|#####4    | 15356/28280 [00:12<00:03, 4054.09it/s]     62%|######1   | 17404/28280 [00:12<00:01, 7371.50it/s]     76%|#######6  | 21500/28280 [00:12<00:00, 11700.88it/s]     83%|########3 | 23548/28280 [00:12<00:00, 12290.11it/s]     91%|######### | 25596/28280 [00:12<00:00, 12502.09it/s]     98%|#########7| 27644/28280 [00:13<00:00, 11252.24it/s]    100%|##########| 28280/28280 [00:13<00:00, 2165.68it/s] 
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  3.93it/s]    100%|##########| 2/2 [00:00<00:00,  4.79it/s]    100%|##########| 2/2 [00:00<00:00,  4.63it/s]
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  5.25it/s]    100%|##########| 2/2 [00:00<00:00,  5.47it/s]    100%|##########| 2/2 [00:00<00:00,  5.43it/s]




.. GENERATED FROM PYTHON SOURCE LINES 135-146

Visualize a montage
----------------------
One way to examine the output of the pyAFQ pipeline is by creating a montage
of images of a particular bundle across a group of participants (or, in this
case, the one participant that was analyzed).

.. note::

  The montage file is copied to the present working directory so that it gets
  properly rendered into the web-page containing this example. It is not
  necessary to do this when running this type of analysis.

.. GENERATED FROM PYTHON SOURCE LINES 146-151

.. code-block:: default


    my_afq.combine_bundle("L_OR")
    montage = my_afq.montage("L_OR", (1, 1), "Axial")
    shutil.copy(montage[0], op.split(montage[0])[-1])




.. image-sg:: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :alt: plot optic radiations
   :srcset: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:00<00:00, 11.17it/s]
      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:04<00:00,  4.75s/it]    100%|##########| 1/1 [00:04<00:00,  4.75s/it]

    'bundle-L_OR_view-Axial_idx-0_montage.png'



.. GENERATED FROM PYTHON SOURCE LINES 152-158

Interactive bundle visualization
--------------------------------
Another way to examine the outputs is to export the individual bundle
figures, which show the streamlines, as well as the ROIs used to define the
bundle. This is an html file, which contains an interactive figure that can
be navigated, zoomed, rotated, etc.

.. GENERATED FROM PYTHON SOURCE LINES 158-162

.. code-block:: default


    bundle_html = my_afq.export("indiv_bundles_figures")
    plotly.io.show(bundle_html["NDARAA948VFH"]["L_OR"])




.. raw:: html
    :file: images/sphx_glr_plot_optic_radiations_002.html





.. GENERATED FROM PYTHON SOURCE LINES 163-186

References
----------
.. [1] Caffarra S, Joo SJ, Bloom D, Kruper J, Rokem A, Yeatman JD. Development
    of the visual white matter pathways mediates development of
    electrophysiological responses in visual cortex. Hum Brain Mapp.
    2021;42(17):5785-5797.

.. [2] Caffarra S, Kanopka K, Kruper J, Richie-Halford A, Roy E, Rokem A,
    Yeatman JD. Development of the alpha rhythm is linked to visual white
    matter pathways and visual detection performance. bioRxiv.
    doi:10.1101/2022.09.03.506461

.. [3] Alexander LM, Escalera J, Ai L, et al. An open resource for
    transdiagnostic research in pediatric mental health and learning
    disorders. Sci Data. 2017;4:170181.

.. [4] Richie-Halford A, Cieslak M, Ai L, et al. An analysis-ready and quality
    controlled resource for pediatric brain white-matter research. Scientific
    Data. 2022;9(1):1-27.

.. [5] Cieslak M, Cook PA, He X, et al. QSIPrep: an integrative platform for
    preprocessing and reconstructing diffusion MRI data. Nat Methods.
    2021;18(7):775-778.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 23 minutes  23.213 seconds)


.. _sphx_glr_download_auto_examples_plot_optic_radiations.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_optic_radiations.py <plot_optic_radiations.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_optic_radiations.ipynb <plot_optic_radiations.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
