
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_optic_radiations.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_optic_radiations.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_optic_radiations.py:


=============================
Plotting the Optic Radiations
=============================

pyAFQ is designed to be customizable and extensible. This example shows how you
can customize it to define a new bundle based on a definition of waypoint and
endpoint ROIs of your design.

In this case, we add the optic radiations, based on work by Caffara et al. [1]_,
[2]_. The optic radiations (OR) are the primary projection of visual information
from the lateral geniculate nucleus of the thalamus to the primary visual
cortex. Studying the optic radiations with dMRI provides a linkage between white
matter tissue properties, visual perception and behavior, and physiological
responses of the visual cortex to visual stimulation.

We start by importing some of the components that we need for this example and
fixing the random seed for reproducibility

.. GENERATED FROM PYTHON SOURCE LINES 21-35

.. code-block:: default


    import os.path as op
    import plotly
    import numpy as np
    import shutil

    from AFQ.api.group import GroupAFQ
    import AFQ.api.bundle_dict as abd
    import AFQ.data.fetch as afd
    from AFQ.definitions.image import ImageFile, RoiImage
    import AFQ.utils.streamlines as aus
    np.random.seed(1234)









.. GENERATED FROM PYTHON SOURCE LINES 36-43

Get dMRI data
---------------
We will analyze one subject from the Healthy Brain Network Processed Open
Diffusion Derivatives dataset (HBN-POD2) [3]_, [4]_. We'll use a fetcher to
get preprocessed dMRI data for one of the >2,000 subjects in that study. The
data gets organized into a BIDS-compatible format in the `~/AFQ_data/HBN`
folder:

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default


    study_dir = afd.fetch_hbn_preproc(["NDARAA948VFH"])[1]





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   3%|2         | 1/36 [00:00<00:13,  2.56it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   3%|2         | 1/36 [00:00<00:13,  2.56it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   6%|5         | 2/36 [00:01<00:28,  1.19it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_dseg.nii.gz:   6%|5         | 2/36 [00:01<00:28,  1.19it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_dseg.nii.gz:   8%|8         | 3/36 [00:01<00:17,  1.87it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:   8%|8         | 3/36 [00:01<00:17,  1.87it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:  11%|#1        | 4/36 [00:04<00:42,  1.32s/it]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  11%|#1        | 4/36 [00:04<00:42,  1.32s/it]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  14%|#3        | 5/36 [00:05<00:35,  1.13s/it]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  14%|#3        | 5/36 [00:05<00:35,  1.13s/it]                             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  17%|#6        | 6/36 [00:05<00:26,  1.13it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  17%|#6        | 6/36 [00:05<00:26,  1.13it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  19%|#9        | 7/36 [00:05<00:21,  1.34it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  19%|#9        | 7/36 [00:05<00:21,  1.34it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  22%|##2       | 8/36 [00:06<00:17,  1.64it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-brain_mask.nii.gz:  22%|##2       | 8/36 [00:06<00:17,  1.64it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-brain_mask.nii.gz:  25%|##5       | 9/36 [00:06<00:13,  2.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  25%|##5       | 9/36 [00:06<00:13,  2.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  28%|##7       | 10/36 [00:06<00:11,  2.26it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_dseg.nii.gz:  28%|##7       | 10/36 [00:06<00:11,  2.26it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_dseg.nii.gz:  31%|###       | 11/36 [00:06<00:08,  2.79it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  31%|###       | 11/36 [00:06<00:08,  2.79it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  33%|###3      | 12/36 [00:07<00:08,  2.73it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  33%|###3      | 12/36 [00:07<00:08,  2.73it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  36%|###6      | 13/36 [00:07<00:07,  3.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  36%|###6      | 13/36 [00:07<00:07,  3.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  39%|###8      | 14/36 [00:07<00:07,  3.04it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  39%|###8      | 14/36 [00:07<00:07,  3.04it/s]                                 Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  42%|####1     | 15/36 [00:08<00:06,  3.00it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_carpetplot.svg:  42%|####1     | 15/36 [00:08<00:06,  3.00it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_carpetplot.svg:  44%|####4     | 16/36 [00:08<00:05,  3.68it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  44%|####4     | 16/36 [00:08<00:05,  3.68it/s]         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  47%|####7     | 17/36 [00:08<00:04,  4.12it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-resampled_b0ref.svg:  47%|####7     | 17/36 [00:08<00:04,  4.12it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-resampled_b0ref.svg:  50%|#####     | 18/36 [00:08<00:03,  4.58it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  50%|#####     | 18/36 [00:08<00:03,  4.58it/s]             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  53%|#####2    | 19/36 [00:08<00:03,  4.68it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_biascorr.svg:  53%|#####2    | 19/36 [00:08<00:03,  4.68it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_biascorr.svg:  56%|#####5    | 20/36 [00:09<00:03,  4.40it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  56%|#####5    | 20/36 [00:09<00:03,  4.40it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  58%|#####8    | 21/36 [00:09<00:03,  4.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  58%|#####8    | 21/36 [00:09<00:03,  4.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  61%|######1   | 22/36 [00:09<00:03,  3.77it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  61%|######1   | 22/36 [00:09<00:03,  3.77it/s]                                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  64%|######3   | 23/36 [00:09<00:03,  3.98it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_t1_2_mni.svg:  64%|######3   | 23/36 [00:09<00:03,  3.98it/s]                                   Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_t1_2_mni.svg:  67%|######6   | 24/36 [00:10<00:02,  4.18it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  67%|######6   | 24/36 [00:10<00:02,  4.18it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  69%|######9   | 25/36 [00:10<00:02,  4.85it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_confounds.tsv:  69%|######9   | 25/36 [00:10<00:02,  4.85it/s]                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_confounds.tsv:  72%|#######2  | 26/36 [00:10<00:01,  5.25it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  72%|#######2  | 26/36 [00:10<00:01,  5.25it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  75%|#######5  | 27/36 [00:10<00:01,  5.84it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-SliceQC_dwi.json:  75%|#######5  | 27/36 [00:10<00:01,  5.84it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-SliceQC_dwi.json:  78%|#######7  | 28/36 [00:10<00:01,  6.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  78%|#######7  | 28/36 [00:10<00:01,  6.02it/s]               Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  81%|########  | 29/36 [00:11<00:01,  4.52it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz:  81%|########  | 29/36 [00:11<00:01,  4.52it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz:  83%|########3 | 30/36 [00:11<00:01,  5.10it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-eddy_cnr.nii.gz:  83%|########3 | 30/36 [00:11<00:01,  5.10it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-eddy_cnr.nii.gz:  86%|########6 | 31/36 [00:11<00:00,  5.69it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.b:  86%|########6 | 31/36 [00:11<00:00,  5.69it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.b:  89%|########8 | 32/36 [00:11<00:00,  5.98it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval:  89%|########8 | 32/36 [00:11<00:00,  5.98it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval:  92%|#########1| 33/36 [00:11<00:00,  6.12it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec:  92%|#########1| 33/36 [00:11<00:00,  6.12it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec:  94%|#########4| 34/36 [00:11<00:00,  5.97it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  94%|#########4| 34/36 [00:11<00:00,  5.97it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  97%|#########7| 35/36 [00:14<00:00,  1.15it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz:  97%|#########7| 35/36 [00:14<00:00,  1.15it/s]              Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz: 100%|##########| 36/36 [00:14<00:00,  1.44it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz: 100%|##########| 36/36 [00:14<00:00,  2.46it/s]




.. GENERATED FROM PYTHON SOURCE LINES 47-57

Define custom `BundleDict` object
--------------------------------
The `BundleDict` object holds information about "include" and "exclude" ROIs,
as well as endpoint ROIS, and whether the bundle crosses the midline. In this
case, the ROIs are all defined in the MNI template space that is used as the
default template space in pyAFQ, but, in principle, other template spaces
could be used.

The ROIs for the case can be downloaded using a custom fetcher and then read
into a dict as follows:

.. GENERATED FROM PYTHON SOURCE LINES 57-88

.. code-block:: default


    or_rois = afd.read_or_templates()

    bundles = abd.BundleDict({
        "L_OR": {
            "include": [
                or_rois["left_OR_1"],
                or_rois["left_OR_2"]],
            "exclude": [
                or_rois["left_OP_MNI"],
                or_rois["left_TP_MNI"],
                or_rois["left_pos_thal_MNI"]],
            "start": or_rois['left_thal_MNI'],
            "end": or_rois['left_V1_MNI'],
            "cross_midline": False,
        },
        "R_OR": {
            "include": [
                or_rois["right_OR_1"],
                or_rois["right_OR_2"]],
            "exclude": [
                or_rois["right_OP_MNI"],
                or_rois["right_TP_MNI"],
                or_rois["right_pos_thal_MNI"]],
            "start": or_rois['right_thal_MNI'],
            "end": or_rois['right_V1_MNI'],
            "cross_midline": False
        }
    })






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4380.47 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2207.53 MB/s]
      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4464.40 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2337.96 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 1936.43 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]      5%|5         | 1/19 [00:00<00:01,  9.99 MB/s]     21%|##1       | 4/19 [00:00<00:00, 21.66 MB/s]     42%|####2     | 8/19 [00:00<00:00, 29.85 MB/s]     84%|########4 | 16/19 [00:00<00:00, 49.39 MB/s]    100%|##########| 19/19 [00:00<00:00, 47.06 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 20.61 MB/s]     89%|########9 | 17/19 [00:00<00:00, 48.52 MB/s]    100%|##########| 19/19 [00:00<00:00, 48.91 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 1462.45 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2267.19 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2549.73 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 20.69 MB/s]     84%|########4 | 16/19 [00:00<00:00, 44.95 MB/s]    100%|##########| 19/19 [00:00<00:00, 48.95 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 20.73 MB/s]     84%|########4 | 16/19 [00:00<00:00, 45.16 MB/s]    100%|##########| 19/19 [00:00<00:00, 49.16 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2353.71 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2344.50 MB/s]
    Downloading https://templateflow.s3.amazonaws.com/tpl-MNI152NLin2009cAsym/tpl-MNI152NLin2009cAsym_res-01_T2w.nii.gz
      0%|          | 0.00/13.3M [00:00<?, ?B/s]      1%|          | 126k/13.3M [00:00<00:12, 1.06MB/s]      9%|8         | 1.15M/13.3M [00:00<00:02, 5.30MB/s]     49%|####8     | 6.47M/13.3M [00:00<00:00, 24.6MB/s]     82%|########1 | 10.9M/13.3M [00:00<00:00, 31.4MB/s]    100%|##########| 13.3M/13.3M [00:00<00:00, 26.8MB/s]




.. GENERATED FROM PYTHON SOURCE LINES 89-96

Custom bundle definitions such as the OR, and the standard BundleDict can be
combined through addition. To get both the OR and the standard bundles, we
would execute the following code::

    bundles = bundles + abd.BundleDict()

In this case, we will skip this and generate just the OR.

.. GENERATED FROM PYTHON SOURCE LINES 99-114

Define GroupAFQ object
----------------------
HBN POD2 have been processed with qsiprep [5]_. This means that a brain mask
has already been computer for them. As you can see in other examples, these
data also have a mapping calculated for them, which can also be incorporated
into processing. However, in this case, we will let pyAFQ calculate its own
SyN-based mapping so that the `combine_bundle` method can be used below to
create a montage visualization.

For tractography, we use CSD-based probabilistic tractography seeding
extensively (`n_seeds=4` means 81 seeds per voxel!), but only within the ROIs
and not throughout the white matter. This is controlled by passing
`"seed_mask": RoiImage()` in the `tracking_params` dict. The custom bundles
are passed as `bundle_info=bundles`. The call to `my_afq.export_all()`
initiates the pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 114-134

.. code-block:: default


    brain_mask_definition = ImageFile(
        suffix="mask",
        filters={'desc': 'brain',
                 'space': 'T1w',
                 'scope': 'qsiprep'})

    my_afq = GroupAFQ(
        bids_path=study_dir,
        preproc_pipeline="qsiprep",
        output_dir=op.join(study_dir, "derivatives", "afq_or"),
        brain_mask_definition=brain_mask_definition,
        tracking_params={"n_seeds": 4,
                         "directions": "prob",
                         "odf_model": "CSD",
                         "seed_mask": RoiImage()},
        bundle_info=bundles)

    my_afq.export_all()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/bids/layout/validation.py:156: UserWarning:

    The PipelineDescription field was superseded by GeneratedBy in BIDS 1.4.0. You can use ``pybids upgrade`` to update your derivative dataset.

      0%|          | 0/234119.0 [00:00<?, ?it/s]      0%|          | 103/234119.0 [00:00<03:48, 1025.20it/s]      0%|          | 475/234119.0 [00:00<01:29, 2606.13it/s]      0%|          | 851/234119.0 [00:00<01:14, 3130.70it/s]      1%|          | 1244/234119.0 [00:00<01:07, 3444.11it/s]      1%|          | 1627/234119.0 [00:00<01:04, 3582.70it/s]      1%|          | 2024/234119.0 [00:00<01:02, 3713.92it/s]      1%|1         | 2416/234119.0 [00:00<01:01, 3779.53it/s]      1%|1         | 2826/234119.0 [00:00<00:59, 3878.89it/s]      1%|1         | 3214/234119.0 [00:00<00:59, 3865.94it/s]      2%|1         | 3615/234119.0 [00:01<00:58, 3909.46it/s]      2%|1         | 4015/234119.0 [00:01<00:58, 3933.70it/s]      2%|1         | 4426/234119.0 [00:01<00:57, 3984.53it/s]      2%|2         | 4825/234119.0 [00:01<00:57, 3953.74it/s]      2%|2         | 5247/234119.0 [00:01<00:56, 4033.02it/s]      2%|2         | 5651/234119.0 [00:01<00:56, 4020.44it/s]      3%|2         | 6058/234119.0 [00:01<00:56, 4033.62it/s]      3%|2         | 6462/234119.0 [00:01<00:57, 3989.14it/s]      3%|2         | 6866/234119.0 [00:01<00:56, 4002.27it/s]      3%|3         | 7298/234119.0 [00:01<00:55, 4096.78it/s]      3%|3         | 7715/234119.0 [00:02<00:54, 4116.75it/s]      3%|3         | 8127/234119.0 [00:02<00:55, 4099.62it/s]      4%|3         | 8552/234119.0 [00:02<00:54, 4143.60it/s]      4%|3         | 8978/234119.0 [00:02<00:53, 4177.93it/s]      4%|4         | 9399/234119.0 [00:02<00:53, 4186.23it/s]      4%|4         | 9818/234119.0 [00:02<00:53, 4180.88it/s]      4%|4         | 10237/234119.0 [00:02<00:53, 4168.54it/s]      5%|4         | 10681/234119.0 [00:02<00:52, 4247.11it/s]      5%|4         | 11118/234119.0 [00:02<00:52, 4282.09it/s]      5%|4         | 11547/234119.0 [00:02<00:52, 4257.20it/s]      5%|5         | 11982/234119.0 [00:03<00:51, 4282.98it/s]      5%|5         | 12411/234119.0 [00:03<00:52, 4246.27it/s]      5%|5         | 12865/234119.0 [00:03<00:51, 4332.24it/s]      6%|5         | 13308/234119.0 [00:03<00:50, 4359.03it/s]      6%|5         | 13745/234119.0 [00:03<00:50, 4327.33it/s]      6%|6         | 14197/234119.0 [00:03<00:50, 4383.47it/s]      6%|6         | 14643/234119.0 [00:03<00:49, 4405.28it/s]      6%|6         | 15084/234119.0 [00:03<00:50, 4373.31it/s]      7%|6         | 15529/234119.0 [00:03<00:49, 4394.64it/s]      7%|6         | 15983/234119.0 [00:03<00:49, 4436.23it/s]      7%|7         | 16440/234119.0 [00:04<00:48, 4475.40it/s]      7%|7         | 16888/234119.0 [00:04<00:48, 4470.43it/s]      7%|7         | 17336/234119.0 [00:04<00:48, 4467.81it/s]      8%|7         | 17783/234119.0 [00:04<00:48, 4455.79it/s]      8%|7         | 18235/234119.0 [00:04<00:48, 4473.98it/s]      8%|7         | 18683/234119.0 [00:04<00:48, 4459.55it/s]      8%|8         | 19129/234119.0 [00:04<00:48, 4447.99it/s]      8%|8         | 19576/234119.0 [00:04<00:48, 4451.63it/s]      9%|8         | 20022/234119.0 [00:04<00:48, 4424.58it/s]      9%|8         | 20465/234119.0 [00:04<00:48, 4366.28it/s]      9%|8         | 20902/234119.0 [00:05<00:48, 4365.13it/s]      9%|9         | 21352/234119.0 [00:05<00:48, 4401.19it/s]      9%|9         | 21809/234119.0 [00:05<00:47, 4451.06it/s]     10%|9         | 22255/234119.0 [00:05<00:47, 4448.42it/s]     10%|9         | 22702/234119.0 [00:05<00:47, 4453.38it/s]     10%|9         | 23148/234119.0 [00:05<00:47, 4454.33it/s]     10%|#         | 23594/234119.0 [00:05<00:47, 4425.87it/s]     10%|#         | 24058/234119.0 [00:05<00:46, 4487.51it/s]     10%|#         | 24507/234119.0 [00:05<00:46, 4484.06it/s]     11%|#         | 24956/234119.0 [00:05<00:47, 4416.00it/s]     11%|#         | 25398/234119.0 [00:06<00:47, 4397.39it/s]     11%|#1        | 25853/234119.0 [00:06<00:46, 4442.29it/s]     11%|#1        | 26314/234119.0 [00:06<00:46, 4491.87it/s]     11%|#1        | 26764/234119.0 [00:06<00:46, 4471.56it/s]     12%|#1        | 27224/234119.0 [00:06<00:45, 4508.58it/s]     12%|#1        | 27676/234119.0 [00:06<00:45, 4511.87it/s]     12%|#2        | 28136/234119.0 [00:06<00:45, 4537.78it/s]     12%|#2        | 28598/234119.0 [00:06<00:45, 4560.72it/s]     12%|#2        | 29055/234119.0 [00:06<00:45, 4550.88it/s]     13%|#2        | 29514/234119.0 [00:06<00:44, 4562.55it/s]     13%|#2        | 29971/234119.0 [00:07<00:45, 4523.76it/s]     13%|#2        | 30424/234119.0 [00:07<00:45, 4497.11it/s]     13%|#3        | 30874/234119.0 [00:07<00:45, 4449.78it/s]     13%|#3        | 31344/234119.0 [00:07<00:44, 4521.03it/s]     14%|#3        | 31800/234119.0 [00:07<00:44, 4530.90it/s]     14%|#3        | 32254/234119.0 [00:07<00:44, 4524.38it/s]     14%|#3        | 32707/234119.0 [00:07<00:44, 4514.62it/s]     14%|#4        | 33159/234119.0 [00:07<00:44, 4492.37it/s]     14%|#4        | 33609/234119.0 [00:07<00:45, 4422.46it/s]     15%|#4        | 34062/234119.0 [00:07<00:44, 4451.77it/s]     15%|#4        | 34512/234119.0 [00:08<00:44, 4462.20it/s]     15%|#4        | 34983/234119.0 [00:08<00:43, 4534.08it/s]     15%|#5        | 35464/234119.0 [00:08<00:43, 4613.45it/s]     15%|#5        | 35926/234119.0 [00:08<00:43, 4600.57it/s]     16%|#5        | 36399/234119.0 [00:08<00:42, 4637.25it/s]     16%|#5        | 36863/234119.0 [00:08<00:42, 4634.11it/s]     16%|#5        | 37327/234119.0 [00:08<00:42, 4593.30it/s]     16%|#6        | 37787/234119.0 [00:08<00:43, 4551.32it/s]     16%|#6        | 38244/234119.0 [00:08<00:42, 4555.90it/s]     17%|#6        | 38713/234119.0 [00:08<00:42, 4594.16it/s]     17%|#6        | 39176/234119.0 [00:09<00:42, 4604.73it/s]     17%|#6        | 39637/234119.0 [00:09<00:42, 4594.97it/s]     17%|#7        | 40106/234119.0 [00:09<00:41, 4621.41it/s]     17%|#7        | 40578/234119.0 [00:09<00:41, 4647.90it/s]     18%|#7        | 41043/234119.0 [00:09<00:42, 4578.11it/s]     18%|#7        | 41508/234119.0 [00:09<00:41, 4598.38it/s]     18%|#7        | 41976/234119.0 [00:09<00:41, 4620.12it/s]     18%|#8        | 42439/234119.0 [00:09<00:42, 4548.99it/s]     18%|#8        | 42914/234119.0 [00:09<00:41, 4605.79it/s]     19%|#8        | 43375/234119.0 [00:09<00:41, 4551.55it/s]     19%|#8        | 43831/234119.0 [00:10<01:20, 2352.32it/s]     19%|#8        | 44271/234119.0 [00:10<01:09, 2718.34it/s]     19%|#9        | 44708/234119.0 [00:10<01:02, 3053.52it/s]     19%|#9        | 45161/234119.0 [00:10<00:55, 3385.20it/s]     19%|#9        | 45627/234119.0 [00:10<00:51, 3694.62it/s]     20%|#9        | 46088/234119.0 [00:10<00:47, 3929.52it/s]     20%|#9        | 46544/234119.0 [00:11<00:45, 4097.61it/s]     20%|##        | 47009/234119.0 [00:11<00:44, 4250.28it/s]     20%|##        | 47483/234119.0 [00:11<00:42, 4388.32it/s]     20%|##        | 47957/234119.0 [00:11<00:41, 4487.94it/s]     21%|##        | 48419/234119.0 [00:11<00:41, 4498.52it/s]     21%|##        | 48879/234119.0 [00:11<00:40, 4525.52it/s]     21%|##1       | 49339/234119.0 [00:11<00:40, 4544.49it/s]     21%|##1       | 49802/234119.0 [00:11<00:40, 4569.75it/s]     21%|##1       | 50263/234119.0 [00:11<00:40, 4573.46it/s]     22%|##1       | 50723/234119.0 [00:11<00:40, 4563.04it/s]     22%|##1       | 51182/234119.0 [00:12<00:40, 4569.01it/s]     22%|##2       | 51661/234119.0 [00:12<00:39, 4632.97it/s]     22%|##2       | 52147/234119.0 [00:12<00:38, 4699.59it/s]     22%|##2       | 52620/234119.0 [00:12<00:38, 4707.12it/s]     23%|##2       | 53092/234119.0 [00:12<00:38, 4654.08it/s]     23%|##2       | 53559/234119.0 [00:12<00:38, 4658.64it/s]     23%|##3       | 54026/234119.0 [00:12<00:38, 4626.57it/s]     23%|##3       | 54510/234119.0 [00:12<00:38, 4687.58it/s]     23%|##3       | 54987/234119.0 [00:12<00:38, 4711.43it/s]     24%|##3       | 55459/234119.0 [00:12<00:38, 4670.75it/s]     24%|##3       | 55944/234119.0 [00:13<00:37, 4723.27it/s]     24%|##4       | 56417/234119.0 [00:13<00:37, 4691.55it/s]     24%|##4       | 56887/234119.0 [00:13<00:37, 4684.07it/s]     24%|##4       | 57356/234119.0 [00:13<00:39, 4455.62it/s]     25%|##4       | 57804/234119.0 [00:13<00:39, 4444.06it/s]     25%|##4       | 58258/234119.0 [00:13<00:39, 4469.23it/s]     25%|##5       | 58734/234119.0 [00:13<00:38, 4552.71it/s]     25%|##5       | 59202/234119.0 [00:13<00:38, 4588.92it/s]     25%|##5       | 59677/234119.0 [00:13<00:37, 4636.28it/s]     26%|##5       | 60160/234119.0 [00:13<00:37, 4693.63it/s]     26%|##5       | 60630/234119.0 [00:14<00:36, 4691.66it/s]     26%|##6       | 61100/234119.0 [00:14<00:36, 4681.84it/s]     26%|##6       | 61569/234119.0 [00:14<00:37, 4597.55it/s]     26%|##6       | 62038/234119.0 [00:14<00:37, 4623.94it/s]     27%|##6       | 62501/234119.0 [00:14<00:37, 4612.64it/s]     27%|##6       | 62987/234119.0 [00:14<00:36, 4685.38it/s]     27%|##7       | 63464/234119.0 [00:14<00:36, 4708.45it/s]     27%|##7       | 63936/234119.0 [00:14<00:36, 4694.73it/s]     28%|##7       | 64421/234119.0 [00:14<00:35, 4739.80it/s]     28%|##7       | 64906/234119.0 [00:14<00:35, 4772.60it/s]     28%|##7       | 65384/234119.0 [00:15<00:35, 4740.57it/s]     28%|##8       | 65859/234119.0 [00:15<00:36, 4648.04it/s]     28%|##8       | 66326/234119.0 [00:15<00:36, 4653.77it/s]     29%|##8       | 66796/234119.0 [00:15<00:35, 4664.70it/s]     29%|##8       | 67296/234119.0 [00:15<00:35, 4760.79it/s]     29%|##8       | 67779/234119.0 [00:15<00:34, 4779.08it/s]     29%|##9       | 68258/234119.0 [00:15<00:35, 4702.73it/s]     29%|##9       | 68729/234119.0 [00:15<00:35, 4647.24it/s]     30%|##9       | 69195/234119.0 [00:15<00:35, 4634.49it/s]     30%|##9       | 69659/234119.0 [00:15<00:35, 4628.87it/s]     30%|##9       | 70123/234119.0 [00:16<00:35, 4567.40it/s]     30%|###       | 70586/234119.0 [00:16<00:35, 4584.01it/s]     30%|###       | 71058/234119.0 [00:16<00:35, 4623.35it/s]     31%|###       | 71528/234119.0 [00:16<00:35, 4644.14it/s]     31%|###       | 72001/234119.0 [00:16<00:34, 4667.96it/s]     31%|###       | 72468/234119.0 [00:16<00:34, 4642.33it/s]     31%|###1      | 72955/234119.0 [00:16<00:34, 4706.22it/s]     31%|###1      | 73438/234119.0 [00:16<00:33, 4742.41it/s]     32%|###1      | 73933/234119.0 [00:16<00:33, 4803.42it/s]     32%|###1      | 74414/234119.0 [00:16<00:33, 4749.15it/s]     32%|###1      | 74890/234119.0 [00:17<00:33, 4712.65it/s]     32%|###2      | 75362/234119.0 [00:17<00:33, 4712.58it/s]     32%|###2      | 75840/234119.0 [00:17<00:33, 4730.06it/s]     33%|###2      | 76314/234119.0 [00:17<00:33, 4730.70it/s]     33%|###2      | 76788/234119.0 [00:17<00:33, 4702.45it/s]     33%|###2      | 77259/234119.0 [00:17<00:33, 4691.28it/s]     33%|###3      | 77739/234119.0 [00:17<00:33, 4720.87it/s]     33%|###3      | 78234/234119.0 [00:17<00:32, 4787.70it/s]     34%|###3      | 78713/234119.0 [00:17<00:32, 4712.14it/s]     34%|###3      | 79185/234119.0 [00:18<00:32, 4714.35it/s]     34%|###4      | 79668/234119.0 [00:18<00:32, 4748.52it/s]     34%|###4      | 80144/234119.0 [00:18<00:32, 4695.97it/s]     34%|###4      | 80614/234119.0 [00:18<00:32, 4695.97it/s]     35%|###4      | 81087/234119.0 [00:18<00:32, 4704.54it/s]     35%|###4      | 81559/234119.0 [00:18<00:32, 4708.27it/s]     35%|###5      | 82044/234119.0 [00:18<00:32, 4749.65it/s]     35%|###5      | 82529/234119.0 [00:18<00:31, 4778.25it/s]     35%|###5      | 83017/234119.0 [00:18<00:31, 4806.44it/s]     36%|###5      | 83498/234119.0 [00:18<00:31, 4759.57it/s]     36%|###5      | 83975/234119.0 [00:19<00:31, 4744.48it/s]     36%|###6      | 84467/234119.0 [00:19<00:31, 4795.10it/s]     36%|###6      | 84947/234119.0 [00:19<00:31, 4790.13it/s]     36%|###6      | 85445/234119.0 [00:19<00:30, 4845.92it/s]     37%|###6      | 85940/234119.0 [00:19<00:30, 4875.54it/s]     37%|###6      | 86428/234119.0 [00:19<00:30, 4849.01it/s]     37%|###7      | 86913/234119.0 [00:19<00:30, 4833.61it/s]     37%|###7      | 87397/234119.0 [00:19<00:31, 4722.57it/s]     38%|###7      | 87870/234119.0 [00:19<00:31, 4717.11it/s]     38%|###7      | 88343/234119.0 [00:19<00:31, 4662.47it/s]     38%|###7      | 88810/234119.0 [00:20<00:31, 4651.96it/s]     38%|###8      | 89276/234119.0 [00:20<00:31, 4622.89it/s]     38%|###8      | 89739/234119.0 [00:20<00:31, 4589.70it/s]     39%|###8      | 90200/234119.0 [00:20<00:31, 4592.66it/s]     39%|###8      | 90662/234119.0 [00:20<00:31, 4600.01it/s]     39%|###8      | 91123/234119.0 [00:20<00:31, 4588.93it/s]     39%|###9      | 91596/234119.0 [00:20<00:30, 4630.17it/s]     39%|###9      | 92060/234119.0 [00:20<00:30, 4602.15it/s]     40%|###9      | 92521/234119.0 [00:20<00:31, 4565.15it/s]     40%|###9      | 92978/234119.0 [00:20<00:31, 4549.27it/s]     40%|###9      | 93433/234119.0 [00:21<00:31, 4506.25it/s]     40%|####      | 93886/234119.0 [00:21<00:31, 4510.90it/s]     40%|####      | 94338/234119.0 [00:21<00:31, 4451.00it/s]     40%|####      | 94784/234119.0 [00:21<00:31, 4451.30it/s]     41%|####      | 95230/234119.0 [00:21<00:31, 4416.05it/s]     41%|####      | 95689/234119.0 [00:21<00:31, 4464.89it/s]     41%|####1     | 96153/234119.0 [00:21<00:30, 4514.60it/s]     41%|####1     | 96605/234119.0 [00:21<00:30, 4496.30it/s]     41%|####1     | 97058/234119.0 [00:21<00:30, 4506.24it/s]     42%|####1     | 97528/234119.0 [00:21<00:29, 4563.64it/s]     42%|####1     | 97996/234119.0 [00:22<00:29, 4596.73it/s]     42%|####2     | 98457/234119.0 [00:22<00:29, 4599.60it/s]     42%|####2     | 98918/234119.0 [00:22<00:29, 4584.43it/s]     42%|####2     | 99400/234119.0 [00:22<00:28, 4653.22it/s]     43%|####2     | 99866/234119.0 [00:22<00:29, 4626.39it/s]     43%|####2     | 100329/234119.0 [00:22<00:29, 4613.31it/s]     43%|####3     | 100791/234119.0 [00:22<00:29, 4501.05it/s]     43%|####3     | 101242/234119.0 [00:22<00:29, 4492.50it/s]     43%|####3     | 101710/234119.0 [00:22<00:29, 4545.49it/s]     44%|####3     | 102166/234119.0 [00:22<00:29, 4546.31it/s]     44%|####3     | 102625/234119.0 [00:23<00:28, 4556.09it/s]     44%|####4     | 103081/234119.0 [00:23<00:28, 4554.27it/s]     44%|####4     | 103537/234119.0 [00:23<00:29, 4485.25it/s]     44%|####4     | 103986/234119.0 [00:23<00:29, 4449.94it/s]     45%|####4     | 104438/234119.0 [00:23<00:29, 4468.49it/s]     45%|####4     | 104909/234119.0 [00:23<00:28, 4539.44it/s]     45%|####5     | 105368/234119.0 [00:23<00:28, 4552.61it/s]     45%|####5     | 105849/234119.0 [00:23<00:27, 4626.59it/s]     45%|####5     | 106337/234119.0 [00:23<00:27, 4702.04it/s]     46%|####5     | 106810/234119.0 [00:23<00:27, 4708.92it/s]     46%|####5     | 107305/234119.0 [00:24<00:26, 4780.14it/s]     46%|####6     | 107784/234119.0 [00:24<00:26, 4750.14it/s]     46%|####6     | 108260/234119.0 [00:24<00:26, 4693.59it/s]     46%|####6     | 108730/234119.0 [00:24<00:26, 4679.63it/s]     47%|####6     | 109199/234119.0 [00:24<00:26, 4650.58it/s]     47%|####6     | 109665/234119.0 [00:24<00:26, 4626.25it/s]     47%|####7     | 110135/234119.0 [00:24<00:26, 4647.88it/s]     47%|####7     | 110607/234119.0 [00:24<00:26, 4666.99it/s]     47%|####7     | 111074/234119.0 [00:24<00:26, 4648.92it/s]     48%|####7     | 111558/234119.0 [00:24<00:26, 4705.70it/s]     48%|####7     | 112029/234119.0 [00:25<00:26, 4614.22it/s]     48%|####8     | 112503/234119.0 [00:25<00:26, 4650.98it/s]     48%|####8     | 112969/234119.0 [00:25<00:26, 4608.22it/s]     48%|####8     | 113431/234119.0 [00:25<00:26, 4581.23it/s]     49%|####8     | 113890/234119.0 [00:25<00:26, 4563.65it/s]     49%|####8     | 114365/234119.0 [00:25<00:25, 4618.77it/s]     49%|####9     | 114828/234119.0 [00:25<00:25, 4591.53it/s]     49%|####9     | 115288/234119.0 [00:25<00:25, 4589.24it/s]     49%|####9     | 115760/234119.0 [00:25<00:25, 4625.85it/s]     50%|####9     | 116231/234119.0 [00:26<00:25, 4650.21it/s]     50%|####9     | 116697/234119.0 [00:26<00:25, 4652.11it/s]     50%|#####     | 117167/234119.0 [00:26<00:25, 4665.05it/s]     50%|#####     | 117634/234119.0 [00:26<00:25, 4639.28it/s]     50%|#####     | 118100/234119.0 [00:26<00:24, 4645.45it/s]     51%|#####     | 118568/234119.0 [00:26<00:24, 4654.97it/s]     51%|#####     | 119034/234119.0 [00:26<00:25, 4579.40it/s]     51%|#####1    | 119493/234119.0 [00:26<00:25, 4550.97it/s]     51%|#####1    | 119949/234119.0 [00:26<00:25, 4532.46it/s]     51%|#####1    | 120403/234119.0 [00:26<00:25, 4512.73it/s]     52%|#####1    | 120858/234119.0 [00:27<00:25, 4521.59it/s]     52%|#####1    | 121318/234119.0 [00:27<00:24, 4544.70it/s]     52%|#####2    | 121773/234119.0 [00:27<00:24, 4534.09it/s]     52%|#####2    | 122227/234119.0 [00:27<00:24, 4523.92it/s]     52%|#####2    | 122697/234119.0 [00:27<00:24, 4574.46it/s]     53%|#####2    | 123155/234119.0 [00:27<00:24, 4560.45it/s]     53%|#####2    | 123612/234119.0 [00:27<00:24, 4540.02it/s]     53%|#####2    | 124067/234119.0 [00:27<00:40, 2724.51it/s]     53%|#####3    | 124525/234119.0 [00:28<00:35, 3101.18it/s]     53%|#####3    | 125002/234119.0 [00:28<00:31, 3476.53it/s]     54%|#####3    | 125460/234119.0 [00:28<00:29, 3744.59it/s]     54%|#####3    | 125926/234119.0 [00:28<00:27, 3979.17it/s]     54%|#####3    | 126368/234119.0 [00:28<00:26, 4096.40it/s]     54%|#####4    | 126817/234119.0 [00:28<00:25, 4203.73it/s]     54%|#####4    | 127279/234119.0 [00:28<00:24, 4321.10it/s]     55%|#####4    | 127740/234119.0 [00:28<00:24, 4403.89it/s]     55%|#####4    | 128199/234119.0 [00:28<00:23, 4456.99it/s]     55%|#####4    | 128681/234119.0 [00:28<00:23, 4562.51it/s]     55%|#####5    | 129152/234119.0 [00:29<00:22, 4604.65it/s]     55%|#####5    | 129632/234119.0 [00:29<00:22, 4659.45it/s]     56%|#####5    | 130106/234119.0 [00:29<00:22, 4679.60it/s]     56%|#####5    | 130577/234119.0 [00:29<00:22, 4617.81it/s]     56%|#####5    | 131041/234119.0 [00:29<00:22, 4542.90it/s]     56%|#####6    | 131507/234119.0 [00:29<00:22, 4575.64it/s]     56%|#####6    | 131966/234119.0 [00:29<00:22, 4560.95it/s]     57%|#####6    | 132430/234119.0 [00:29<00:22, 4582.87it/s]     57%|#####6    | 132905/234119.0 [00:29<00:21, 4629.95it/s]     57%|#####6    | 133381/234119.0 [00:29<00:21, 4668.24it/s]     57%|#####7    | 133857/234119.0 [00:30<00:21, 4693.77it/s]     57%|#####7    | 134347/234119.0 [00:30<00:20, 4753.99it/s]     58%|#####7    | 134835/234119.0 [00:30<00:20, 4791.32it/s]     58%|#####7    | 135315/234119.0 [00:30<00:21, 4656.94it/s]     58%|#####7    | 135787/234119.0 [00:30<00:21, 4673.84it/s]     58%|#####8    | 136259/234119.0 [00:30<00:20, 4683.23it/s]     58%|#####8    | 136728/234119.0 [00:30<00:20, 4671.26it/s]     59%|#####8    | 137201/234119.0 [00:30<00:20, 4685.18it/s]     59%|#####8    | 137670/234119.0 [00:30<00:20, 4683.17it/s]     59%|#####9    | 138139/234119.0 [00:30<00:20, 4658.74it/s]     59%|#####9    | 138611/234119.0 [00:31<00:20, 4674.54it/s]     59%|#####9    | 139087/234119.0 [00:31<00:20, 4697.87it/s]     60%|#####9    | 139557/234119.0 [00:31<00:20, 4659.80it/s]     60%|#####9    | 140024/234119.0 [00:31<00:20, 4651.40it/s]     60%|######    | 140492/234119.0 [00:31<00:20, 4659.35it/s]     60%|######    | 140958/234119.0 [00:31<00:20, 4632.40it/s]     60%|######    | 141424/234119.0 [00:31<00:19, 4639.70it/s]     61%|######    | 141904/234119.0 [00:31<00:19, 4686.20it/s]     61%|######    | 142378/234119.0 [00:31<00:19, 4699.51it/s]     61%|######1   | 142850/234119.0 [00:31<00:19, 4702.54it/s]     61%|######1   | 143321/234119.0 [00:32<00:19, 4652.43it/s]     61%|######1   | 143795/234119.0 [00:32<00:19, 4676.91it/s]     62%|######1   | 144263/234119.0 [00:32<00:19, 4609.25it/s]     62%|######1   | 144725/234119.0 [00:32<00:19, 4555.23it/s]     62%|######2   | 145199/234119.0 [00:32<00:19, 4606.71it/s]     62%|######2   | 145660/234119.0 [00:32<00:19, 4604.12it/s]     62%|######2   | 146121/234119.0 [00:32<00:19, 4596.59it/s]     63%|######2   | 146605/234119.0 [00:32<00:18, 4667.79it/s]     63%|######2   | 147094/234119.0 [00:32<00:18, 4731.38it/s]     63%|######3   | 147575/234119.0 [00:33<00:18, 4752.54it/s]     63%|######3   | 148060/234119.0 [00:33<00:18, 4781.04it/s]     63%|######3   | 148539/234119.0 [00:33<00:18, 4739.81it/s]     64%|######3   | 149014/234119.0 [00:33<00:18, 4641.23it/s]     64%|######3   | 149479/234119.0 [00:33<00:18, 4636.70it/s]     64%|######4   | 149958/234119.0 [00:33<00:17, 4679.15it/s]     64%|######4   | 150436/234119.0 [00:33<00:17, 4708.07it/s]     64%|######4   | 150908/234119.0 [00:33<00:17, 4710.25it/s]     65%|######4   | 151383/234119.0 [00:33<00:17, 4719.13it/s]     65%|######4   | 151865/234119.0 [00:33<00:17, 4746.64it/s]     65%|######5   | 152353/234119.0 [00:34<00:17, 4784.22it/s]     65%|######5   | 152832/234119.0 [00:34<00:17, 4758.28it/s]     65%|######5   | 153308/234119.0 [00:34<00:16, 4754.09it/s]     66%|######5   | 153784/234119.0 [00:34<00:17, 4713.02it/s]     66%|######5   | 154277/234119.0 [00:34<00:16, 4777.23it/s]     66%|######6   | 154755/234119.0 [00:34<00:16, 4736.19it/s]     66%|######6   | 155251/234119.0 [00:34<00:16, 4800.80it/s]     67%|######6   | 155734/234119.0 [00:34<00:16, 4808.06it/s]     67%|######6   | 156215/234119.0 [00:34<00:16, 4807.38it/s]     67%|######6   | 156696/234119.0 [00:34<00:16, 4791.52it/s]     67%|######7   | 157176/234119.0 [00:35<00:16, 4714.81it/s]     67%|######7   | 157648/234119.0 [00:35<00:16, 4646.64it/s]     68%|######7   | 158129/234119.0 [00:35<00:16, 4694.08it/s]     68%|######7   | 158612/234119.0 [00:35<00:15, 4733.71it/s]     68%|######7   | 159086/234119.0 [00:35<00:15, 4691.28it/s]     68%|######8   | 159575/234119.0 [00:35<00:15, 4748.69it/s]     68%|######8   | 160052/234119.0 [00:35<00:15, 4751.85it/s]     69%|######8   | 160528/234119.0 [00:35<00:15, 4726.55it/s]     69%|######8   | 161018/234119.0 [00:35<00:15, 4776.80it/s]     69%|######8   | 161496/234119.0 [00:35<00:15, 4753.12it/s]     69%|######9   | 161972/234119.0 [00:36<00:15, 4675.71it/s]     69%|######9   | 162443/234119.0 [00:36<00:15, 4683.24it/s]     70%|######9   | 162921/234119.0 [00:36<00:15, 4709.13it/s]     70%|######9   | 163394/234119.0 [00:36<00:15, 4713.38it/s]     70%|######9   | 163875/234119.0 [00:36<00:14, 4740.17it/s]     70%|#######   | 164354/234119.0 [00:36<00:14, 4754.33it/s]     70%|#######   | 164838/234119.0 [00:36<00:14, 4779.66it/s]     71%|#######   | 165322/234119.0 [00:36<00:14, 4797.57it/s]     71%|#######   | 165817/234119.0 [00:36<00:14, 4841.51it/s]     71%|#######1  | 166302/234119.0 [00:36<00:14, 4731.49it/s]     71%|#######1  | 166776/234119.0 [00:37<00:14, 4699.79it/s]     71%|#######1  | 167255/234119.0 [00:37<00:14, 4726.16it/s]     72%|#######1  | 167736/234119.0 [00:37<00:13, 4750.62it/s]     72%|#######1  | 168219/234119.0 [00:37<00:13, 4771.31it/s]     72%|#######2  | 168711/234119.0 [00:37<00:13, 4813.01it/s]     72%|#######2  | 169198/234119.0 [00:37<00:13, 4828.25it/s]     72%|#######2  | 169691/234119.0 [00:37<00:13, 4857.65it/s]     73%|#######2  | 170177/234119.0 [00:37<00:13, 4771.01it/s]     73%|#######2  | 170655/234119.0 [00:37<00:13, 4666.11it/s]     73%|#######3  | 171123/234119.0 [00:37<00:13, 4627.53it/s]     73%|#######3  | 171596/234119.0 [00:38<00:13, 4657.18it/s]     73%|#######3  | 172073/234119.0 [00:38<00:13, 4690.19it/s]     74%|#######3  | 172554/234119.0 [00:38<00:13, 4723.81it/s]     74%|#######3  | 173033/234119.0 [00:38<00:12, 4740.97it/s]     74%|#######4  | 173514/234119.0 [00:38<00:12, 4760.84it/s]     74%|#######4  | 174015/234119.0 [00:38<00:12, 4834.14it/s]     75%|#######4  | 174499/234119.0 [00:38<00:12, 4791.56it/s]     75%|#######4  | 174979/234119.0 [00:38<00:12, 4724.84it/s]     75%|#######4  | 175456/234119.0 [00:38<00:12, 4737.09it/s]     75%|#######5  | 175930/234119.0 [00:38<00:12, 4729.55it/s]     75%|#######5  | 176421/234119.0 [00:39<00:12, 4782.85it/s]     76%|#######5  | 176900/234119.0 [00:39<00:12, 4767.19it/s]     76%|#######5  | 177383/234119.0 [00:39<00:11, 4785.46it/s]     76%|#######5  | 177873/234119.0 [00:39<00:11, 4818.85it/s]     76%|#######6  | 178355/234119.0 [00:39<00:11, 4776.51it/s]     76%|#######6  | 178833/234119.0 [00:39<00:11, 4750.08it/s]     77%|#######6  | 179309/234119.0 [00:39<00:11, 4719.23it/s]     77%|#######6  | 179786/234119.0 [00:39<00:11, 4733.79it/s]     77%|#######6  | 180262/234119.0 [00:39<00:11, 4740.90it/s]     77%|#######7  | 180745/234119.0 [00:39<00:11, 4765.56it/s]     77%|#######7  | 181224/234119.0 [00:40<00:11, 4770.65it/s]     78%|#######7  | 181707/234119.0 [00:40<00:10, 4786.46it/s]     78%|#######7  | 182186/234119.0 [00:40<00:10, 4770.79it/s]     78%|#######8  | 182664/234119.0 [00:40<00:10, 4730.03it/s]     78%|#######8  | 183138/234119.0 [00:40<00:10, 4683.01it/s]     78%|#######8  | 183607/234119.0 [00:40<00:10, 4648.79it/s]     79%|#######8  | 184072/234119.0 [00:40<00:10, 4645.99it/s]     79%|#######8  | 184537/234119.0 [00:40<00:10, 4641.26it/s]     79%|#######9  | 185012/234119.0 [00:40<00:10, 4672.25it/s]     79%|#######9  | 185480/234119.0 [00:41<00:10, 4659.44it/s]     79%|#######9  | 185946/234119.0 [00:41<00:10, 4632.54it/s]     80%|#######9  | 186410/234119.0 [00:41<00:10, 4613.06it/s]     80%|#######9  | 186872/234119.0 [00:41<00:10, 4583.02it/s]     80%|########  | 187331/234119.0 [00:41<00:10, 4559.76it/s]     80%|########  | 187797/234119.0 [00:41<00:10, 4588.47it/s]     80%|########  | 188258/234119.0 [00:41<00:09, 4593.11it/s]     81%|########  | 188718/234119.0 [00:41<00:09, 4593.89it/s]     81%|########  | 189178/234119.0 [00:41<00:09, 4585.46it/s]     81%|########1 | 189651/234119.0 [00:41<00:09, 4626.74it/s]     81%|########1 | 190118/234119.0 [00:42<00:09, 4638.98it/s]     81%|########1 | 190585/234119.0 [00:42<00:09, 4645.03it/s]     82%|########1 | 191050/234119.0 [00:42<00:09, 4598.65it/s]     82%|########1 | 191510/234119.0 [00:42<00:09, 4589.85it/s]     82%|########1 | 191977/234119.0 [00:42<00:09, 4611.68it/s]     82%|########2 | 192444/234119.0 [00:42<00:09, 4627.05it/s]     82%|########2 | 192918/234119.0 [00:42<00:08, 4660.79it/s]     83%|########2 | 193385/234119.0 [00:42<00:08, 4660.96it/s]     83%|########2 | 193862/234119.0 [00:42<00:08, 4690.67it/s]     83%|########3 | 194332/234119.0 [00:42<00:08, 4674.47it/s]     83%|########3 | 194800/234119.0 [00:43<00:08, 4658.93it/s]     83%|########3 | 195266/234119.0 [00:43<00:08, 4646.02it/s]     84%|########3 | 195731/234119.0 [00:43<00:08, 4635.08it/s]     84%|########3 | 196201/234119.0 [00:43<00:08, 4652.62it/s]     84%|########4 | 196669/234119.0 [00:43<00:08, 4660.07it/s]     84%|########4 | 197136/234119.0 [00:43<00:07, 4639.96it/s]     84%|########4 | 197603/234119.0 [00:43<00:07, 4648.32it/s]     85%|########4 | 198068/234119.0 [00:43<00:07, 4631.71it/s]     85%|########4 | 198532/234119.0 [00:43<00:07, 4518.70it/s]     85%|########4 | 198985/234119.0 [00:43<00:07, 4506.38it/s]     85%|########5 | 199441/234119.0 [00:44<00:07, 4520.56it/s]     85%|########5 | 199913/234119.0 [00:44<00:07, 4579.63it/s]     86%|########5 | 200383/234119.0 [00:44<00:07, 4612.51it/s]     86%|########5 | 200852/234119.0 [00:44<00:07, 4633.52it/s]     86%|########5 | 201326/234119.0 [00:44<00:07, 4662.90it/s]     86%|########6 | 201798/234119.0 [00:44<00:06, 4679.65it/s]     86%|########6 | 202267/234119.0 [00:44<00:06, 4626.38it/s]     87%|########6 | 202730/234119.0 [00:44<00:06, 4603.55it/s]     87%|########6 | 203212/234119.0 [00:44<00:06, 4666.07it/s]     87%|########7 | 203685/234119.0 [00:44<00:06, 4683.15it/s]     87%|########7 | 204154/234119.0 [00:45<00:06, 4674.86it/s]     87%|########7 | 204635/234119.0 [00:45<00:06, 4714.07it/s]     88%|########7 | 205107/234119.0 [00:45<00:06, 4705.83it/s]     88%|########7 | 205578/234119.0 [00:45<00:06, 4660.62it/s]     88%|########8 | 206045/234119.0 [00:45<00:06, 4661.29it/s]     88%|########8 | 206513/234119.0 [00:45<00:05, 4666.77it/s]     88%|########8 | 206998/234119.0 [00:45<00:05, 4719.98it/s]     89%|########8 | 207476/234119.0 [00:45<00:05, 4737.83it/s]     89%|########8 | 207955/234119.0 [00:45<00:05, 4752.83it/s]     89%|########9 | 208431/234119.0 [00:45<00:05, 4685.50it/s]     89%|########9 | 208900/234119.0 [00:46<00:05, 4610.28it/s]     89%|########9 | 209362/234119.0 [00:46<00:05, 4607.97it/s]     90%|########9 | 209846/234119.0 [00:46<00:05, 4674.05it/s]     90%|########9 | 210316/234119.0 [00:46<00:05, 4681.67it/s]     90%|######### | 210790/234119.0 [00:46<00:04, 4696.34it/s]     90%|######### | 211260/234119.0 [00:46<00:04, 4651.71it/s]     90%|######### | 211726/234119.0 [00:46<00:04, 4599.13it/s]     91%|######### | 212187/234119.0 [00:46<00:04, 4574.64it/s]     91%|######### | 212659/234119.0 [00:46<00:04, 4615.89it/s]     91%|#########1| 213124/234119.0 [00:46<00:04, 4623.93it/s]     91%|#########1| 213590/234119.0 [00:47<00:04, 4633.35it/s]     91%|#########1| 214055/234119.0 [00:47<00:04, 4635.57it/s]     92%|#########1| 214532/234119.0 [00:47<00:04, 4672.45it/s]     92%|#########1| 215000/234119.0 [00:47<00:04, 4606.37it/s]     92%|#########2| 215470/234119.0 [00:47<00:04, 4631.27it/s]     92%|#########2| 215942/234119.0 [00:47<00:03, 4655.50it/s]     92%|#########2| 216408/234119.0 [00:47<00:03, 4577.04it/s]     93%|#########2| 216867/234119.0 [00:47<00:03, 4484.66it/s]     93%|#########2| 217317/234119.0 [00:47<00:03, 4448.59it/s]     93%|#########3| 217763/234119.0 [00:48<00:03, 4399.08it/s]     93%|#########3| 218209/234119.0 [00:48<00:03, 4415.79it/s]     93%|#########3| 218663/234119.0 [00:48<00:03, 4450.19it/s]     94%|#########3| 219109/234119.0 [00:48<00:03, 4411.56it/s]     94%|#########3| 219563/234119.0 [00:48<00:03, 4447.37it/s]     94%|#########3| 220013/234119.0 [00:48<00:03, 4462.06it/s]     94%|#########4| 220460/234119.0 [00:48<00:03, 4437.90it/s]     94%|#########4| 220915/234119.0 [00:48<00:02, 4470.79it/s]     95%|#########4| 221373/234119.0 [00:48<00:02, 4499.74it/s]     95%|#########4| 221834/234119.0 [00:48<00:02, 4532.59it/s]     95%|#########4| 222288/234119.0 [00:49<00:02, 4529.15it/s]     95%|#########5| 222756/234119.0 [00:49<00:02, 4573.64it/s]     95%|#########5| 223214/234119.0 [00:49<00:02, 4557.47it/s]     96%|#########5| 223679/234119.0 [00:49<00:02, 4584.83it/s]     96%|#########5| 224145/234119.0 [00:49<00:02, 4603.20it/s]     96%|#########5| 224617/234119.0 [00:49<00:02, 4636.05it/s]     96%|#########6| 225081/234119.0 [00:49<00:03, 2741.04it/s]     96%|#########6| 225532/234119.0 [00:49<00:02, 3095.89it/s]     97%|#########6| 225995/234119.0 [00:50<00:02, 3438.23it/s]     97%|#########6| 226446/234119.0 [00:50<00:02, 3697.00it/s]     97%|#########6| 226908/234119.0 [00:50<00:01, 3933.04it/s]     97%|#########7| 227370/234119.0 [00:50<00:01, 4117.15it/s]     97%|#########7| 227814/234119.0 [00:50<00:01, 4182.72it/s]     97%|#########7| 228259/234119.0 [00:50<00:01, 4256.44it/s]     98%|#########7| 228701/234119.0 [00:50<00:01, 4299.81it/s]     98%|#########7| 229144/234119.0 [00:50<00:01, 4337.43it/s]     98%|#########8| 229586/234119.0 [00:50<00:01, 4317.36it/s]     98%|#########8| 230046/234119.0 [00:50<00:00, 4399.19it/s]     98%|#########8| 230499/234119.0 [00:51<00:00, 4436.13it/s]     99%|#########8| 230952/234119.0 [00:51<00:00, 4461.61it/s]     99%|#########8| 231401/234119.0 [00:51<00:00, 4462.42it/s]     99%|#########9| 231866/234119.0 [00:51<00:00, 4517.27it/s]     99%|#########9| 232319/234119.0 [00:51<00:00, 4502.65it/s]     99%|#########9| 232771/234119.0 [00:51<00:00, 4494.14it/s]    100%|#########9| 233234/234119.0 [00:51<00:00, 4534.40it/s]    100%|#########9| 233701/234119.0 [00:51<00:00, 4572.59it/s]    100%|##########| 234119/234119.0 [00:51<00:00, 4509.25it/s]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
      0%|          | 0/28181 [00:00<?, ?it/s]      0%|          | 4/28181 [00:05<9:59:45,  1.28s/it]      0%|          | 18/28181 [00:05<1:42:42,  4.57it/s]      3%|2         | 782/28181 [00:05<01:35, 287.74it/s]      7%|7         | 2062/28181 [00:05<00:28, 917.24it/s]     15%|#4        | 4110/28181 [00:05<00:11, 2159.56it/s]     29%|##9       | 8206/28181 [00:05<00:04, 4943.84it/s]     36%|###6      | 10254/28181 [00:05<00:02, 6009.34it/s]     44%|####3     | 12302/28181 [00:06<00:02, 7455.67it/s]     51%|#####     | 14350/28181 [00:06<00:01, 8565.80it/s]     58%|#####8    | 16398/28181 [00:06<00:01, 8885.45it/s]     65%|######5   | 18446/28181 [00:06<00:01, 7131.29it/s]     73%|#######2  | 20494/28181 [00:07<00:01, 4657.13it/s]     80%|#######9  | 22542/28181 [00:09<00:02, 2649.03it/s]     87%|########7 | 24590/28181 [00:10<00:01, 2013.77it/s]     95%|#########4| 26638/28181 [00:12<00:01, 1502.88it/s]     96%|#########5| 26994/28181 [00:14<00:01, 1093.32it/s]     97%|#########7| 27350/28181 [00:15<00:00, 1039.00it/s]     98%|#########8| 27706/28181 [00:15<00:00, 994.22it/s]     100%|#########9| 28062/28181 [00:15<00:00, 1072.21it/s]    100%|##########| 28181/28181 [00:15<00:00, 1799.44it/s]
      0%|          | 0/28181 [00:00<?, ?it/s]      0%|          | 28/28181 [00:00<01:47, 260.94it/s]      1%|          | 188/28181 [00:00<00:28, 990.80it/s]      2%|1         | 508/28181 [00:00<00:20, 1347.45it/s]      4%|3         | 1020/28181 [00:00<00:14, 1875.43it/s]      5%|4         | 1276/28181 [00:00<00:16, 1626.41it/s]      5%|5         | 1532/28181 [00:01<00:19, 1377.00it/s]      6%|6         | 1788/28181 [00:01<00:16, 1555.52it/s]      7%|7         | 2044/28181 [00:01<00:16, 1558.87it/s]      8%|8         | 2300/28181 [00:01<00:17, 1465.20it/s]      9%|9         | 2556/28181 [00:01<00:16, 1557.84it/s]     11%|#         | 3068/28181 [00:01<00:12, 1947.73it/s]     12%|#1        | 3324/28181 [00:02<00:12, 1934.38it/s]     13%|#2        | 3580/28181 [00:02<00:14, 1695.27it/s]     14%|#3        | 3836/28181 [00:02<00:17, 1364.78it/s]     15%|#4        | 4092/28181 [00:02<00:17, 1404.52it/s]     15%|#5        | 4348/28181 [00:02<00:15, 1497.50it/s]     16%|#6        | 4604/28181 [00:03<00:16, 1448.83it/s]     17%|#7        | 4860/28181 [00:03<00:16, 1433.65it/s]     18%|#8        | 5116/28181 [00:03<00:16, 1375.21it/s]     19%|#9        | 5372/28181 [00:03<00:19, 1170.07it/s]     20%|#9        | 5628/28181 [00:03<00:21, 1051.84it/s]     21%|##        | 5884/28181 [00:04<00:19, 1170.34it/s]     22%|##1       | 6140/28181 [00:04<00:20, 1082.12it/s]     23%|##2       | 6396/28181 [00:04<00:22, 989.41it/s]      24%|##3       | 6652/28181 [00:04<00:19, 1092.77it/s]     25%|##4       | 6908/28181 [00:05<00:17, 1210.94it/s]     25%|##5       | 7164/28181 [00:05<00:16, 1266.72it/s]     26%|##6       | 7420/28181 [00:05<00:20, 1022.03it/s]     27%|##7       | 7676/28181 [00:05<00:17, 1153.53it/s]     28%|##8       | 7932/28181 [00:05<00:16, 1222.37it/s]     29%|##9       | 8188/28181 [00:06<00:21, 939.85it/s]      30%|##9       | 8444/28181 [00:06<00:22, 862.53it/s]     31%|###       | 8700/28181 [00:06<00:18, 1051.17it/s]     32%|###1      | 8956/28181 [00:07<00:16, 1134.04it/s]     33%|###2      | 9212/28181 [00:07<00:19, 996.44it/s]      34%|###3      | 9468/28181 [00:07<00:19, 972.98it/s]     35%|###4      | 9724/28181 [00:07<00:19, 947.71it/s]     35%|###5      | 9980/28181 [00:08<00:19, 914.99it/s]     36%|###6      | 10236/28181 [00:08<00:19, 916.97it/s]     37%|###7      | 10492/28181 [00:08<00:16, 1067.04it/s]     38%|###8      | 10748/28181 [00:08<00:17, 1012.69it/s]     39%|###9      | 11004/28181 [00:09<00:16, 1072.83it/s]     40%|###9      | 11260/28181 [00:09<00:16, 1023.51it/s]     41%|####      | 11516/28181 [00:09<00:15, 1109.37it/s]     42%|####1     | 11772/28181 [00:09<00:13, 1226.95it/s]     43%|####2     | 12028/28181 [00:10<00:16, 994.56it/s]      44%|####3     | 12284/28181 [00:10<00:13, 1177.58it/s]     44%|####4     | 12540/28181 [00:10<00:12, 1271.83it/s]     45%|####5     | 12796/28181 [00:10<00:10, 1425.19it/s]     46%|####6     | 13052/28181 [00:10<00:10, 1482.96it/s]     48%|####8     | 13564/28181 [00:10<00:08, 1735.25it/s]     50%|####9     | 14076/28181 [00:11<00:06, 2276.80it/s]     54%|#####4    | 15356/28181 [00:11<00:02, 4377.76it/s]     62%|######1   | 17404/28181 [00:11<00:01, 7956.59it/s]     76%|#######6  | 21500/28181 [00:11<00:00, 12246.86it/s]     84%|########3 | 23548/28181 [00:11<00:00, 12945.52it/s]     91%|######### | 25596/28181 [00:11<00:00, 13612.11it/s]     98%|#########8| 27644/28181 [00:11<00:00, 14092.49it/s]    100%|##########| 28181/28181 [00:11<00:00, 2368.52it/s] 
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  4.08it/s]    100%|##########| 2/2 [00:00<00:00,  4.55it/s]    100%|##########| 2/2 [00:00<00:00,  4.47it/s]
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  4.73it/s]    100%|##########| 2/2 [00:00<00:00,  4.84it/s]    100%|##########| 2/2 [00:00<00:00,  4.82it/s]




.. GENERATED FROM PYTHON SOURCE LINES 135-146

Visualize a montage
----------------------
One way to examine the output of the pyAFQ pipeline is by creating a montage
of images of a particular bundle across a group of participants (or, in this
case, the one participant that was analyzed).

.. note::

  The montage file is copied to the present working directory so that it gets
  properly rendered into the web-page containing this example. It is not
  necessary to do this when running this type of analysis.

.. GENERATED FROM PYTHON SOURCE LINES 146-151

.. code-block:: default


    my_afq.combine_bundle("L_OR")
    montage = my_afq.montage("L_OR", (1, 1), "Axial")
    shutil.copy(montage[0], op.split(montage[0])[-1])




.. image-sg:: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :alt: plot optic radiations
   :srcset: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:00<00:00, 12.06it/s]
      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:04<00:00,  4.26s/it]    100%|##########| 1/1 [00:04<00:00,  4.26s/it]

    'bundle-L_OR_view-Axial_idx-0_montage.png'



.. GENERATED FROM PYTHON SOURCE LINES 152-158

Interactive bundle visualization
--------------------------------
Another way to examine the outputs is to export the individual bundle
figures, which show the streamlines, as well as the ROIs used to define the
bundle. This is an html file, which contains an interactive figure that can
be navigated, zoomed, rotated, etc.

.. GENERATED FROM PYTHON SOURCE LINES 158-162

.. code-block:: default


    bundle_html = my_afq.export("indiv_bundles_figures")
    plotly.io.show(bundle_html["NDARAA948VFH"]["L_OR"])




.. raw:: html
    :file: images/sphx_glr_plot_optic_radiations_002.html





.. GENERATED FROM PYTHON SOURCE LINES 163-186

References
----------
.. [1] Caffarra S, Joo SJ, Bloom D, Kruper J, Rokem A, Yeatman JD. Development
    of the visual white matter pathways mediates development of
    electrophysiological responses in visual cortex. Hum Brain Mapp.
    2021;42(17):5785-5797.

.. [2] Caffarra S, Kanopka K, Kruper J, Richie-Halford A, Roy E, Rokem A,
    Yeatman JD. Development of the alpha rhythm is linked to visual white
    matter pathways and visual detection performance. bioRxiv.
    doi:10.1101/2022.09.03.506461

.. [3] Alexander LM, Escalera J, Ai L, et al. An open resource for
    transdiagnostic research in pediatric mental health and learning
    disorders. Sci Data. 2017;4:170181.

.. [4] Richie-Halford A, Cieslak M, Ai L, et al. An analysis-ready and quality
    controlled resource for pediatric brain white-matter research. Scientific
    Data. 2022;9(1):1-27.

.. [5] Cieslak M, Cook PA, He X, et al. QSIPrep: an integrative platform for
    preprocessing and reconstructing diffusion MRI data. Nat Methods.
    2021;18(7):775-778.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 21 minutes  47.320 seconds)


.. _sphx_glr_download_auto_examples_plot_optic_radiations.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_optic_radiations.py <plot_optic_radiations.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_optic_radiations.ipynb <plot_optic_radiations.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
