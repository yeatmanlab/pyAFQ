
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_optic_radiations.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_optic_radiations.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_optic_radiations.py:


=============================
Plotting the Optic Radiations
=============================

pyAFQ is designed to be customizable and extensible. This example shows how you
can customize it to define a new bundle based on a definition of waypoint and
endpoint ROIs of your design.

In this case, we add the optic radiations, based on work by Caffara et al. [1]_,
[2]_. The optic radiations (OR) are the primary projection of visual information
from the lateral geniculate nucleus of the thalamus to the primary visual
cortex. Studying the optic radiations with dMRI provides a linkage between white
matter tissue properties, visual perception and behavior, and physiological
responses of the visual cortex to visual stimulation.

We start by importing some of the components that we need for this example and
fixing the random seed for reproducibility

.. GENERATED FROM PYTHON SOURCE LINES 21-35

.. code-block:: default


    import os.path as op
    import plotly
    import numpy as np
    import shutil

    from AFQ.api.group import GroupAFQ
    import AFQ.api.bundle_dict as abd
    import AFQ.data.fetch as afd
    from AFQ.definitions.image import ImageFile, RoiImage
    import AFQ.utils.streamlines as aus
    np.random.seed(1234)









.. GENERATED FROM PYTHON SOURCE LINES 36-43

Get dMRI data
---------------
We will analyze one subject from the Healthy Brain Network Processed Open
Diffusion Derivatives dataset (HBN-POD2) [3]_, [4]_. We'll use a fetcher to
get preprocessed dMRI data for one of the >2,000 subjects in that study. The
data gets organized into a BIDS-compatible format in the `~/AFQ_data/HBN`
folder:

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default


    study_dir = afd.fetch_hbn_preproc(["NDARAA948VFH"])[1]





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   0%|          | 0/36 [00:00<?, ?it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-brain_mask.nii.gz:   3%|2         | 1/36 [00:00<00:03,  9.54it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   3%|2         | 1/36 [00:00<00:03,  9.54it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_desc-preproc_T1w.nii.gz:   6%|5         | 2/36 [00:00<00:14,  2.27it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_dseg.nii.gz:   6%|5         | 2/36 [00:00<00:14,  2.27it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:   8%|8         | 3/36 [00:00<00:14,  2.27it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-MNI152NLin2009cAsym_to-T1w_mode-image_xfm.h5:  11%|#1        | 4/36 [00:01<00:13,  2.45it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  11%|#1        | 4/36 [00:01<00:13,  2.45it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_from-T1w_to-MNI152NLin2009cAsym_mode-image_xfm.h5:  14%|#3        | 5/36 [00:01<00:12,  2.52it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  14%|#3        | 5/36 [00:01<00:12,  2.52it/s]                             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-CSF_probseg.nii.gz:  17%|#6        | 6/36 [00:02<00:09,  3.13it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  17%|#6        | 6/36 [00:02<00:09,  3.13it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-GM_probseg.nii.gz:  19%|#9        | 7/36 [00:02<00:10,  2.79it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  19%|#9        | 7/36 [00:02<00:10,  2.79it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_label-WM_probseg.nii.gz:  22%|##2       | 8/36 [00:02<00:08,  3.34it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-brain_mask.nii.gz:  22%|##2       | 8/36 [00:02<00:08,  3.34it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  25%|##5       | 9/36 [00:02<00:08,  3.34it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_desc-preproc_T1w.nii.gz:  28%|##7       | 10/36 [00:02<00:05,  4.63it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_dseg.nii.gz:  28%|##7       | 10/36 [00:02<00:05,  4.63it/s]                Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  31%|###       | 11/36 [00:02<00:05,  4.63it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-CSF_probseg.nii.gz:  33%|###3      | 12/36 [00:03<00:04,  5.75it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  33%|###3      | 12/36 [00:03<00:04,  5.75it/s]     Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-GM_probseg.nii.gz:  36%|###6      | 13/36 [00:03<00:03,  5.78it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  36%|###6      | 13/36 [00:03<00:03,  5.78it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/anat/sub-NDARAA948VFH_space-MNI152NLin2009cAsym_label-WM_probseg.nii.gz:  39%|###8      | 14/36 [00:03<00:03,  6.02it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  39%|###8      | 14/36 [00:03<00:03,  6.02it/s]                                 Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_seg_brainmask.svg:  42%|####1     | 15/36 [00:03<00:03,  5.90it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_carpetplot.svg:  42%|####1     | 15/36 [00:03<00:03,  5.90it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  44%|####4     | 16/36 [00:03<00:03,  5.90it/s]         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_coreg.svg:  47%|####7     | 17/36 [00:03<00:02,  7.92it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-resampled_b0ref.svg:  47%|####7     | 17/36 [00:03<00:02,  7.92it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  50%|#####     | 18/36 [00:03<00:02,  7.92it/s]             Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-sdc_b0.svg:  53%|#####2    | 19/36 [00:03<00:01,  9.50it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_biascorr.svg:  53%|#####2    | 19/36 [00:03<00:01,  9.50it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  56%|#####5    | 20/36 [00:04<00:01,  9.50it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_denoising.svg:  58%|#####8    | 21/36 [00:04<00:01,  8.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  58%|#####8    | 21/36 [00:04<00:01,  8.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwi_denoise_ses_HBNsiteRU_acq_64dir_dwi_wf_unringing.svg:  61%|######1   | 22/36 [00:04<00:01,  8.06it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  61%|######1   | 22/36 [00:04<00:01,  8.06it/s]                                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_sampling_scheme.gif:  64%|######3   | 23/36 [00:04<00:01,  7.65it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/figures/sub-NDARAA948VFH_t1_2_mni.svg:  64%|######3   | 23/36 [00:04<00:01,  7.65it/s]                                   Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  67%|######6   | 24/36 [00:04<00:01,  7.65it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/anat/sub-NDARAA948VFH_ses-HBNsiteRU_acq-HCP_from-orig_to-T1w_mode-image_xfm.txt:  69%|######9   | 25/36 [00:04<00:01,  9.46it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_confounds.tsv:  69%|######9   | 25/36 [00:04<00:01,  9.46it/s]                         Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  72%|#######2  | 26/36 [00:04<00:01,  9.46it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-ImageQC_dwi.csv:  75%|#######5  | 27/36 [00:04<00:00, 11.11it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_desc-SliceQC_dwi.json:  75%|#######5  | 27/36 [00:04<00:00, 11.11it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  78%|#######7  | 28/36 [00:04<00:00, 11.11it/s]               Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_dwiqc.json:  81%|########  | 29/36 [00:04<00:00, 10.37it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz:  81%|########  | 29/36 [00:04<00:00, 10.37it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-eddy_cnr.nii.gz:  83%|########3 | 30/36 [00:05<00:00, 10.37it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.b:  86%|########6 | 31/36 [00:05<00:00, 10.37it/s]      Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.b:  89%|########8 | 32/36 [00:05<00:00, 13.33it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval:  89%|########8 | 32/36 [00:05<00:00, 13.33it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec:  92%|#########1| 33/36 [00:05<00:00, 13.33it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  94%|#########4| 34/36 [00:05<00:00, 13.33it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz:  97%|#########7| 35/36 [00:06<00:00,  4.32it/s]    Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz:  97%|#########7| 35/36 [00:06<00:00,  4.32it/s]              Downloading /home/runner/AFQ_data/HBN/derivatives/qsiprep/sub-NDARAA948VFH/ses-HBNsiteRU/dwi/sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_dwiref.nii.gz: 100%|##########| 36/36 [00:06<00:00,  5.33it/s]




.. GENERATED FROM PYTHON SOURCE LINES 47-57

Define custom `BundleDict` object
--------------------------------
The `BundleDict` object holds information about "include" and "exclude" ROIs,
as well as endpoint ROIS, and whether the bundle crosses the midline. In this
case, the ROIs are all defined in the MNI template space that is used as the
default template space in pyAFQ, but, in principle, other template spaces
could be used.

The ROIs for the case can be downloaded using a custom fetcher and then read
into a dict as follows:

.. GENERATED FROM PYTHON SOURCE LINES 57-88

.. code-block:: default


    or_rois = afd.read_or_templates()

    bundles = abd.BundleDict({
        "L_OR": {
            "include": [
                or_rois["left_OR_1"],
                or_rois["left_OR_2"]],
            "exclude": [
                or_rois["left_OP_MNI"],
                or_rois["left_TP_MNI"],
                or_rois["left_pos_thal_MNI"]],
            "start": or_rois['left_thal_MNI'],
            "end": or_rois['left_V1_MNI'],
            "cross_midline": False,
        },
        "R_OR": {
            "include": [
                or_rois["right_OR_1"],
                or_rois["right_OR_2"]],
            "exclude": [
                or_rois["right_OP_MNI"],
                or_rois["right_TP_MNI"],
                or_rois["right_pos_thal_MNI"]],
            "start": or_rois['right_thal_MNI'],
            "end": or_rois['right_V1_MNI'],
            "cross_midline": False
        }
    })






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4362.25 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2451.38 MB/s]
      0%|          | 0/2 [00:00<?, ? MB/s]    100%|##########| 2/2 [00:00<00:00, 4723.32 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2454.24 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2680.07 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 30.10 MB/s]     68%|######8   | 13/19 [00:00<00:00, 58.42 MB/s]    100%|##########| 19/19 [00:00<00:00, 71.03 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 30.11 MB/s]     53%|#####2    | 10/19 [00:00<00:00, 38.95 MB/s]    100%|##########| 19/19 [00:00<00:00, 57.08 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2554.39 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2298.25 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2874.78 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 29.69 MB/s]     63%|######3   | 12/19 [00:00<00:00, 47.08 MB/s]    100%|##########| 19/19 [00:00<00:00, 70.16 MB/s]
      0%|          | 0/19 [00:00<?, ? MB/s]     21%|##1       | 4/19 [00:00<00:00, 29.89 MB/s]     84%|########4 | 16/19 [00:00<00:00, 64.84 MB/s]    100%|##########| 19/19 [00:00<00:00, 70.57 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 1986.88 MB/s]
      0%|          | 0/1 [00:00<?, ? MB/s]    100%|##########| 1/1 [00:00<00:00, 2293.22 MB/s]
    Downloading https://templateflow.s3.amazonaws.com/tpl-MNI152NLin2009cAsym/tpl-MNI152NLin2009cAsym_res-01_T2w.nii.gz
      0%|          | 0.00/13.3M [00:00<?, ?B/s]     43%|####2     | 5.71M/13.3M [00:00<00:00, 57.1MB/s]    100%|##########| 13.3M/13.3M [00:00<00:00, 68.1MB/s]    100%|##########| 13.3M/13.3M [00:00<00:00, 66.1MB/s]




.. GENERATED FROM PYTHON SOURCE LINES 89-96

Custom bundle definitions such as the OR, and the standard BundleDict can be
combined through addition. To get both the OR and the standard bundles, we
would execute the following code::

    bundles = bundles + abd.BundleDict()

In this case, we will skip this and generate just the OR.

.. GENERATED FROM PYTHON SOURCE LINES 99-114

Define GroupAFQ object
----------------------
HBN POD2 have been processed with qsiprep [5]_. This means that a brain mask
has already been computer for them. As you can see in other examples, these
data also have a mapping calculated for them, which can also be incorporated
into processing. However, in this case, we will let pyAFQ calculate its own
SyN-based mapping so that the `combine_bundle` method can be used below to
create a montage visualization.

For tractography, we use CSD-based probabilistic tractography seeding
extensively (`n_seeds=4` means 81 seeds per voxel!), but only within the ROIs
and not throughout the white matter. This is controlled by passing
`"seed_mask": RoiImage()` in the `tracking_params` dict. The custom bundles
are passed as `bundle_info=bundles`. The call to `my_afq.export_all()`
initiates the pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 114-134

.. code-block:: default


    brain_mask_definition = ImageFile(
        suffix="mask",
        filters={'desc': 'brain',
                 'space': 'T1w',
                 'scope': 'qsiprep'})

    my_afq = GroupAFQ(
        bids_path=study_dir,
        preproc_pipeline="qsiprep",
        output_dir=op.join(study_dir, "derivatives", "afq_or"),
        brain_mask_definition=brain_mask_definition,
        tracking_params={"n_seeds": 4,
                         "directions": "prob",
                         "odf_model": "CSD",
                         "seed_mask": RoiImage()},
        bundle_info=bundles)

    my_afq.export_all()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.8.16/x64/lib/python3.8/site-packages/bids/layout/validation.py:156: UserWarning:

    The PipelineDescription field was superseded by GeneratedBy in BIDS 1.4.0. You can use ``pybids upgrade`` to update your derivative dataset.

      0%|          | 0/234119.0 [00:00<?, ?it/s]      0%|          | 43/234119.0 [00:00<09:04, 429.61it/s]      0%|          | 335/234119.0 [00:00<02:03, 1893.41it/s]      0%|          | 718/234119.0 [00:00<01:24, 2777.35it/s]      0%|          | 1075/234119.0 [00:00<01:15, 3086.85it/s]      1%|          | 1448/234119.0 [00:00<01:10, 3316.14it/s]      1%|          | 1842/234119.0 [00:00<01:05, 3525.78it/s]      1%|          | 2228/234119.0 [00:00<01:03, 3633.20it/s]      1%|1         | 2606/234119.0 [00:00<01:02, 3678.29it/s]      1%|1         | 2993/234119.0 [00:00<01:01, 3733.22it/s]      1%|1         | 3367/234119.0 [00:01<01:03, 3630.11it/s]      2%|1         | 3743/234119.0 [00:01<01:02, 3665.49it/s]      2%|1         | 4145/234119.0 [00:01<01:00, 3771.04it/s]      2%|1         | 4525/234119.0 [00:01<01:00, 3777.37it/s]      2%|2         | 4911/234119.0 [00:01<01:00, 3796.22it/s]      2%|2         | 5316/234119.0 [00:01<00:59, 3871.59it/s]      2%|2         | 5704/234119.0 [00:01<00:59, 3870.77it/s]      3%|2         | 6103/234119.0 [00:01<00:58, 3904.76it/s]      3%|2         | 6494/234119.0 [00:01<00:58, 3858.82it/s]      3%|2         | 6881/234119.0 [00:01<00:59, 3838.60it/s]      3%|3         | 7272/234119.0 [00:02<00:58, 3858.83it/s]      3%|3         | 7659/234119.0 [00:02<00:59, 3832.64it/s]      3%|3         | 8055/234119.0 [00:02<00:58, 3868.72it/s]      4%|3         | 8466/234119.0 [00:02<00:57, 3939.39it/s]      4%|3         | 8872/234119.0 [00:02<00:56, 3972.69it/s]      4%|3         | 9279/234119.0 [00:02<00:56, 3998.77it/s]      4%|4         | 9679/234119.0 [00:02<00:57, 3931.56it/s]      4%|4         | 10075/234119.0 [00:02<00:57, 3907.29it/s]      4%|4         | 10509/234119.0 [00:02<00:55, 4032.05it/s]      5%|4         | 10918/234119.0 [00:02<00:55, 4049.09it/s]      5%|4         | 11324/234119.0 [00:03<00:56, 3974.35it/s]      5%|5         | 11732/234119.0 [00:03<00:55, 4003.39it/s]      5%|5         | 12146/234119.0 [00:03<00:54, 4041.89it/s]      5%|5         | 12551/234119.0 [00:03<00:55, 4026.69it/s]      6%|5         | 12973/234119.0 [00:03<00:54, 4081.47it/s]      6%|5         | 13382/234119.0 [00:03<00:54, 4051.48it/s]      6%|5         | 13788/234119.0 [00:03<00:56, 3933.65it/s]      6%|6         | 14183/234119.0 [00:03<00:55, 3932.92it/s]      6%|6         | 14594/234119.0 [00:03<00:55, 3983.63it/s]      6%|6         | 15006/234119.0 [00:03<00:54, 4023.61it/s]      7%|6         | 15431/234119.0 [00:04<00:53, 4089.22it/s]      7%|6         | 15853/234119.0 [00:04<00:52, 4127.48it/s]      7%|6         | 16283/234119.0 [00:04<00:52, 4177.14it/s]      7%|7         | 16705/234119.0 [00:04<00:51, 4186.41it/s]      7%|7         | 17142/234119.0 [00:04<00:51, 4240.03it/s]      8%|7         | 17567/234119.0 [00:04<00:52, 4162.83it/s]      8%|7         | 17992/234119.0 [00:04<00:51, 4188.49it/s]      8%|7         | 18428/234119.0 [00:04<00:50, 4238.89it/s]      8%|8         | 18853/234119.0 [00:04<00:50, 4231.74it/s]      8%|8         | 19280/234119.0 [00:04<00:50, 4241.94it/s]      8%|8         | 19713/234119.0 [00:05<00:50, 4266.13it/s]      9%|8         | 20140/234119.0 [00:05<00:50, 4226.91it/s]      9%|8         | 20563/234119.0 [00:05<00:50, 4195.83it/s]      9%|8         | 21005/234119.0 [00:05<00:50, 4261.71it/s]      9%|9         | 21435/234119.0 [00:05<00:49, 4271.63it/s]      9%|9         | 21870/234119.0 [00:05<00:49, 4293.80it/s]     10%|9         | 22304/234119.0 [00:05<00:49, 4305.41it/s]     10%|9         | 22735/234119.0 [00:05<00:49, 4294.31it/s]     10%|9         | 23165/234119.0 [00:05<00:49, 4242.95it/s]     10%|#         | 23590/234119.0 [00:05<00:49, 4242.92it/s]     10%|#         | 24025/234119.0 [00:06<00:49, 4272.42it/s]     10%|#         | 24461/234119.0 [00:06<00:48, 4295.22it/s]     11%|#         | 24910/234119.0 [00:06<00:48, 4350.35it/s]     11%|#         | 25346/234119.0 [00:06<00:48, 4313.48it/s]     11%|#1        | 25783/234119.0 [00:06<00:48, 4328.87it/s]     11%|#1        | 26221/234119.0 [00:06<00:47, 4343.34it/s]     11%|#1        | 26656/234119.0 [00:06<00:48, 4297.79it/s]     12%|#1        | 27086/234119.0 [00:06<00:48, 4292.49it/s]     12%|#1        | 27529/234119.0 [00:06<00:47, 4332.25it/s]     12%|#1        | 27981/234119.0 [00:06<00:47, 4383.91it/s]     12%|#2        | 28420/234119.0 [00:07<00:47, 4375.51it/s]     12%|#2        | 28858/234119.0 [00:07<00:47, 4345.21it/s]     13%|#2        | 29293/234119.0 [00:07<00:47, 4309.41it/s]     13%|#2        | 29725/234119.0 [00:07<00:47, 4287.86it/s]     13%|#2        | 30154/234119.0 [00:07<00:48, 4230.18it/s]     13%|#3        | 30578/234119.0 [00:07<00:48, 4179.60it/s]     13%|#3        | 30997/234119.0 [00:07<00:48, 4158.43it/s]     13%|#3        | 31425/234119.0 [00:07<00:48, 4193.55it/s]     14%|#3        | 31845/234119.0 [00:07<00:48, 4192.59it/s]     14%|#3        | 32266/234119.0 [00:08<00:48, 4193.29it/s]     14%|#3        | 32686/234119.0 [00:08<00:48, 4164.10it/s]     14%|#4        | 33103/234119.0 [00:08<00:48, 4153.27it/s]     14%|#4        | 33519/234119.0 [00:08<00:48, 4133.41it/s]     14%|#4        | 33933/234119.0 [00:08<00:48, 4110.77it/s]     15%|#4        | 34364/234119.0 [00:08<00:47, 4166.47it/s]     15%|#4        | 34810/234119.0 [00:08<00:46, 4251.38it/s]     15%|#5        | 35265/234119.0 [00:08<00:45, 4337.66it/s]     15%|#5        | 35699/234119.0 [00:08<00:45, 4333.54it/s]     15%|#5        | 36133/234119.0 [00:08<00:46, 4271.33it/s]     16%|#5        | 36561/234119.0 [00:09<00:46, 4240.05it/s]     16%|#5        | 37004/234119.0 [00:09<00:45, 4293.95it/s]     16%|#5        | 37434/234119.0 [00:09<00:46, 4255.50it/s]     16%|#6        | 37860/234119.0 [00:09<00:46, 4235.19it/s]     16%|#6        | 38284/234119.0 [00:09<00:46, 4209.63it/s]     17%|#6        | 38706/234119.0 [00:09<00:46, 4185.67it/s]     17%|#6        | 39142/234119.0 [00:09<00:46, 4237.02it/s]     17%|#6        | 39566/234119.0 [00:09<00:45, 4232.97it/s]     17%|#7        | 39990/234119.0 [00:09<00:46, 4196.25it/s]     17%|#7        | 40429/234119.0 [00:09<00:45, 4253.11it/s]     17%|#7        | 40855/234119.0 [00:10<00:46, 4200.77it/s]     18%|#7        | 41276/234119.0 [00:10<02:41, 1191.88it/s]     18%|#7        | 41698/234119.0 [00:11<02:06, 1515.48it/s]     18%|#8        | 42144/234119.0 [00:11<01:40, 1905.20it/s]     18%|#8        | 42538/234119.0 [00:11<01:25, 2227.94it/s]     18%|#8        | 42987/234119.0 [00:11<01:12, 2646.00it/s]     19%|#8        | 43415/234119.0 [00:11<01:03, 2986.70it/s]     19%|#8        | 43869/234119.0 [00:11<00:56, 3343.70it/s]     19%|#8        | 44318/234119.0 [00:11<00:52, 3626.65it/s]     19%|#9        | 44748/234119.0 [00:11<00:50, 3784.19it/s]     19%|#9        | 45176/234119.0 [00:11<00:48, 3905.56it/s]     19%|#9        | 45607/234119.0 [00:11<00:46, 4015.99it/s]     20%|#9        | 46043/234119.0 [00:12<00:45, 4111.93it/s]     20%|#9        | 46473/234119.0 [00:12<00:45, 4146.09it/s]     20%|##        | 46907/234119.0 [00:12<00:44, 4200.59it/s]     20%|##        | 47340/234119.0 [00:12<00:44, 4238.40it/s]     20%|##        | 47786/234119.0 [00:12<00:43, 4302.79it/s]     21%|##        | 48221/234119.0 [00:12<00:43, 4283.34it/s]     21%|##        | 48659/234119.0 [00:12<00:43, 4311.51it/s]     21%|##        | 49093/234119.0 [00:12<00:43, 4263.32it/s]     21%|##1       | 49522/234119.0 [00:12<00:43, 4214.50it/s]     21%|##1       | 49949/234119.0 [00:13<00:43, 4229.51it/s]     22%|##1       | 50377/234119.0 [00:13<00:43, 4241.79it/s]     22%|##1       | 50822/234119.0 [00:13<00:42, 4301.61it/s]     22%|##1       | 51253/234119.0 [00:13<00:42, 4296.78it/s]     22%|##2       | 51715/234119.0 [00:13<00:41, 4392.98it/s]     22%|##2       | 52178/234119.0 [00:13<00:40, 4462.78it/s]     22%|##2       | 52625/234119.0 [00:13<00:40, 4458.17it/s]     23%|##2       | 53071/234119.0 [00:13<00:41, 4359.17it/s]     23%|##2       | 53508/234119.0 [00:13<00:42, 4239.18it/s]     23%|##3       | 53933/234119.0 [00:13<00:43, 4173.59it/s]     23%|##3       | 54352/234119.0 [00:14<00:43, 4112.21it/s]     23%|##3       | 54764/234119.0 [00:14<00:43, 4076.63it/s]     24%|##3       | 55179/234119.0 [00:14<00:43, 4096.78it/s]     24%|##3       | 55599/234119.0 [00:14<00:43, 4125.31it/s]     24%|##3       | 56047/234119.0 [00:14<00:42, 4228.69it/s]     24%|##4       | 56476/234119.0 [00:14<00:41, 4246.63it/s]     24%|##4       | 56918/234119.0 [00:14<00:41, 4295.90it/s]     24%|##4       | 57348/234119.0 [00:14<00:41, 4222.12it/s]     25%|##4       | 57773/234119.0 [00:14<00:41, 4229.11it/s]     25%|##4       | 58197/234119.0 [00:14<00:41, 4224.68it/s]     25%|##5       | 58628/234119.0 [00:15<00:41, 4249.30it/s]     25%|##5       | 59072/234119.0 [00:15<00:40, 4305.41it/s]     25%|##5       | 59513/234119.0 [00:15<00:40, 4333.47it/s]     26%|##5       | 59961/234119.0 [00:15<00:39, 4376.34it/s]     26%|##5       | 60407/234119.0 [00:15<00:39, 4399.45it/s]     26%|##5       | 60857/234119.0 [00:15<00:39, 4427.80it/s]     26%|##6       | 61300/234119.0 [00:15<00:39, 4405.61it/s]     26%|##6       | 61741/234119.0 [00:15<00:39, 4314.83it/s]     27%|##6       | 62173/234119.0 [00:15<00:40, 4265.84it/s]     27%|##6       | 62606/234119.0 [00:15<00:40, 4280.72it/s]     27%|##6       | 63069/234119.0 [00:16<00:39, 4383.72it/s]     27%|##7       | 63528/234119.0 [00:16<00:38, 4443.63it/s]     27%|##7       | 63979/234119.0 [00:16<00:38, 4461.37it/s]     28%|##7       | 64438/234119.0 [00:16<00:37, 4497.31it/s]     28%|##7       | 64897/234119.0 [00:16<00:37, 4523.09it/s]     28%|##7       | 65350/234119.0 [00:16<00:37, 4474.11it/s]     28%|##8       | 65798/234119.0 [00:16<00:38, 4409.80it/s]     28%|##8       | 66240/234119.0 [00:16<00:38, 4351.23it/s]     28%|##8       | 66676/234119.0 [00:16<00:38, 4336.51it/s]     29%|##8       | 67135/234119.0 [00:16<00:37, 4409.04it/s]     29%|##8       | 67588/234119.0 [00:17<00:37, 4442.71it/s]     29%|##9       | 68040/234119.0 [00:17<00:37, 4463.68it/s]     29%|##9       | 68487/234119.0 [00:17<00:37, 4420.73it/s]     29%|##9       | 68930/234119.0 [00:17<00:38, 4334.14it/s]     30%|##9       | 69392/234119.0 [00:17<00:37, 4415.93it/s]     30%|##9       | 69835/234119.0 [00:17<00:37, 4346.35it/s]     30%|###       | 70271/234119.0 [00:17<00:38, 4295.36it/s]     30%|###       | 70701/234119.0 [00:17<00:38, 4286.58it/s]     30%|###       | 71135/234119.0 [00:17<00:37, 4299.38it/s]     31%|###       | 71577/234119.0 [00:18<00:37, 4331.43it/s]     31%|###       | 72019/234119.0 [00:18<00:37, 4357.29it/s]     31%|###       | 72468/234119.0 [00:18<00:36, 4395.99it/s]     31%|###1      | 72931/234119.0 [00:18<00:36, 4464.80it/s]     31%|###1      | 73385/234119.0 [00:18<00:35, 4486.82it/s]     32%|###1      | 73850/234119.0 [00:18<00:35, 4534.14it/s]     32%|###1      | 74304/234119.0 [00:18<00:35, 4461.45it/s]     32%|###1      | 74751/234119.0 [00:18<00:36, 4367.93it/s]     32%|###2      | 75194/234119.0 [00:18<00:36, 4385.21it/s]     32%|###2      | 75651/234119.0 [00:18<00:35, 4438.62it/s]     33%|###2      | 76101/234119.0 [00:19<00:35, 4456.16it/s]     33%|###2      | 76547/234119.0 [00:19<00:36, 4303.34it/s]     33%|###2      | 76996/234119.0 [00:19<00:36, 4355.60it/s]     33%|###3      | 77447/234119.0 [00:19<00:35, 4400.50it/s]     33%|###3      | 77901/234119.0 [00:19<00:35, 4440.68it/s]     33%|###3      | 78359/234119.0 [00:19<00:34, 4481.58it/s]     34%|###3      | 78808/234119.0 [00:19<00:35, 4399.20it/s]     34%|###3      | 79252/234119.0 [00:19<00:35, 4410.85it/s]     34%|###4      | 79694/234119.0 [00:19<00:35, 4406.01it/s]     34%|###4      | 80139/234119.0 [00:19<00:34, 4417.27it/s]     34%|###4      | 80581/234119.0 [00:20<00:34, 4414.48it/s]     35%|###4      | 81031/234119.0 [00:20<00:34, 4437.76it/s]     35%|###4      | 81481/234119.0 [00:20<00:34, 4455.15it/s]     35%|###4      | 81930/234119.0 [00:20<00:34, 4464.40it/s]     35%|###5      | 82380/234119.0 [00:20<00:33, 4473.34it/s]     35%|###5      | 82828/234119.0 [00:20<00:34, 4440.35it/s]     36%|###5      | 83273/234119.0 [00:20<00:34, 4385.02it/s]     36%|###5      | 83715/234119.0 [00:20<00:34, 4393.72it/s]     36%|###5      | 84162/234119.0 [00:20<00:33, 4414.53it/s]     36%|###6      | 84608/234119.0 [00:20<00:33, 4426.45it/s]     36%|###6      | 85052/234119.0 [00:21<00:33, 4429.11it/s]     37%|###6      | 85521/234119.0 [00:21<00:32, 4503.75it/s]     37%|###6      | 85992/234119.0 [00:21<00:32, 4565.15it/s]     37%|###6      | 86449/234119.0 [00:21<00:32, 4519.34it/s]     37%|###7      | 86902/234119.0 [00:21<00:32, 4500.80it/s]     37%|###7      | 87353/234119.0 [00:21<00:32, 4478.44it/s]     38%|###7      | 87801/234119.0 [00:21<00:33, 4348.41it/s]     38%|###7      | 88237/234119.0 [00:21<00:33, 4319.20it/s]     38%|###7      | 88670/234119.0 [00:21<00:34, 4274.82it/s]     38%|###8      | 89098/234119.0 [00:21<00:34, 4258.58it/s]     38%|###8      | 89525/234119.0 [00:22<00:34, 4201.07it/s]     38%|###8      | 89976/234119.0 [00:22<00:33, 4288.57it/s]     39%|###8      | 90430/234119.0 [00:22<00:32, 4360.98it/s]     39%|###8      | 90876/234119.0 [00:22<00:32, 4389.46it/s]     39%|###9      | 91324/234119.0 [00:22<00:32, 4415.74it/s]     39%|###9      | 91766/234119.0 [00:22<00:32, 4410.09it/s]     39%|###9      | 92208/234119.0 [00:22<00:32, 4410.46it/s]     40%|###9      | 92650/234119.0 [00:22<00:32, 4390.73it/s]     40%|###9      | 93097/234119.0 [00:22<00:31, 4411.87it/s]     40%|###9      | 93539/234119.0 [00:22<00:32, 4321.11it/s]     40%|####      | 93977/234119.0 [00:23<00:32, 4336.27it/s]     40%|####      | 94412/234119.0 [00:23<00:32, 4340.32it/s]     41%|####      | 94849/234119.0 [00:23<00:32, 4346.77it/s]     41%|####      | 95284/234119.0 [00:23<00:32, 4335.68it/s]     41%|####      | 95738/234119.0 [00:23<00:31, 4395.75it/s]     41%|####1     | 96178/234119.0 [00:23<00:31, 4390.34it/s]     41%|####1     | 96618/234119.0 [00:23<00:32, 4288.89it/s]     41%|####1     | 97048/234119.0 [00:23<00:32, 4172.74it/s]     42%|####1     | 97479/234119.0 [00:23<00:32, 4210.11it/s]     42%|####1     | 97912/234119.0 [00:24<00:32, 4244.14it/s]     42%|####2     | 98357/234119.0 [00:24<00:31, 4302.60it/s]     42%|####2     | 98809/234119.0 [00:24<00:30, 4366.06it/s]     42%|####2     | 99265/234119.0 [00:24<00:30, 4421.05it/s]     43%|####2     | 99708/234119.0 [00:24<00:30, 4404.72it/s]     43%|####2     | 100150/234119.0 [00:24<00:30, 4408.91it/s]     43%|####2     | 100593/234119.0 [00:24<00:30, 4411.21it/s]     43%|####3     | 101035/234119.0 [00:24<00:30, 4383.17it/s]     43%|####3     | 101474/234119.0 [00:24<00:30, 4371.46it/s]     44%|####3     | 101912/234119.0 [00:24<00:30, 4371.72it/s]     44%|####3     | 102350/234119.0 [00:25<00:30, 4365.84it/s]     44%|####3     | 102787/234119.0 [00:25<00:30, 4361.29it/s]     44%|####4     | 103224/234119.0 [00:25<00:30, 4332.09it/s]     44%|####4     | 103661/234119.0 [00:25<00:30, 4341.43it/s]     44%|####4     | 104107/234119.0 [00:25<00:29, 4375.39it/s]     45%|####4     | 104545/234119.0 [00:25<00:29, 4364.78it/s]     45%|####4     | 104982/234119.0 [00:25<00:29, 4341.92it/s]     45%|####5     | 105417/234119.0 [00:25<00:30, 4257.94it/s]     45%|####5     | 105844/234119.0 [00:25<00:30, 4234.59it/s]     45%|####5     | 106303/234119.0 [00:25<00:29, 4336.28it/s]     46%|####5     | 106742/234119.0 [00:26<00:29, 4350.20it/s]     46%|####5     | 107193/234119.0 [00:26<00:28, 4395.56it/s]     46%|####5     | 107650/234119.0 [00:26<00:28, 4446.62it/s]     46%|####6     | 108095/234119.0 [00:26<00:28, 4423.93it/s]     46%|####6     | 108538/234119.0 [00:26<00:28, 4403.78it/s]     47%|####6     | 108979/234119.0 [00:26<00:28, 4363.56it/s]     47%|####6     | 109416/234119.0 [00:26<00:28, 4314.13it/s]     47%|####6     | 109856/234119.0 [00:26<00:28, 4338.00it/s]     47%|####7     | 110314/234119.0 [00:26<00:28, 4407.57it/s]     47%|####7     | 110755/234119.0 [00:26<00:28, 4398.63it/s]     47%|####7     | 111195/234119.0 [00:27<00:28, 4387.01it/s]     48%|####7     | 111649/234119.0 [00:27<00:27, 4431.58it/s]     48%|####7     | 112093/234119.0 [00:27<00:27, 4430.41it/s]     48%|####8     | 112537/234119.0 [00:27<00:27, 4399.36it/s]     48%|####8     | 112978/234119.0 [00:27<00:27, 4371.44it/s]     48%|####8     | 113416/234119.0 [00:27<00:28, 4270.11it/s]     49%|####8     | 113844/234119.0 [00:27<00:28, 4222.89it/s]     49%|####8     | 114273/234119.0 [00:27<00:28, 4240.29it/s]     49%|####8     | 114698/234119.0 [00:27<00:28, 4211.41it/s]     49%|####9     | 115126/234119.0 [00:27<00:28, 4230.56it/s]     49%|####9     | 115570/234119.0 [00:28<00:27, 4292.49it/s]     50%|####9     | 116009/234119.0 [00:28<00:27, 4319.53it/s]     50%|####9     | 116445/234119.0 [00:28<00:27, 4330.46it/s]     50%|####9     | 116897/234119.0 [00:28<00:26, 4385.65it/s]     50%|#####     | 117337/234119.0 [00:28<00:26, 4388.16it/s]     50%|#####     | 117776/234119.0 [00:28<00:26, 4354.70it/s]     50%|#####     | 118224/234119.0 [00:28<00:26, 4390.78it/s]     51%|#####     | 118674/234119.0 [00:28<00:26, 4421.89it/s]     51%|#####     | 119117/234119.0 [00:28<00:26, 4357.35it/s]     51%|#####1    | 119561/234119.0 [00:28<00:26, 4381.25it/s]     51%|#####1    | 120000/234119.0 [00:29<00:26, 4372.60it/s]     51%|#####1    | 120455/234119.0 [00:29<00:25, 4425.37it/s]     52%|#####1    | 120906/234119.0 [00:29<00:25, 4450.43it/s]     52%|#####1    | 121355/234119.0 [00:29<00:25, 4460.23it/s]     52%|#####2    | 121802/234119.0 [00:29<00:43, 2600.66it/s]     52%|#####2    | 122202/234119.0 [00:29<00:38, 2879.13it/s]     52%|#####2    | 122646/234119.0 [00:29<00:34, 3224.24it/s]     53%|#####2    | 123087/234119.0 [00:30<00:31, 3507.45it/s]     53%|#####2    | 123521/234119.0 [00:30<00:29, 3718.31it/s]     53%|#####2    | 123976/234119.0 [00:30<00:27, 3939.98it/s]     53%|#####3    | 124415/234119.0 [00:30<00:27, 4062.50it/s]     53%|#####3    | 124866/234119.0 [00:30<00:26, 4188.93it/s]     54%|#####3    | 125315/234119.0 [00:30<00:25, 4274.87it/s]     54%|#####3    | 125762/234119.0 [00:30<00:25, 4330.87it/s]     54%|#####3    | 126204/234119.0 [00:30<00:24, 4320.75it/s]     54%|#####4    | 126643/234119.0 [00:30<00:25, 4294.37it/s]     54%|#####4    | 127078/234119.0 [00:30<00:24, 4308.60it/s]     54%|#####4    | 127512/234119.0 [00:31<00:24, 4278.59it/s]     55%|#####4    | 127956/234119.0 [00:31<00:24, 4324.97it/s]     55%|#####4    | 128405/234119.0 [00:31<00:24, 4371.94it/s]     55%|#####5    | 128853/234119.0 [00:31<00:23, 4403.74it/s]     55%|#####5    | 129302/234119.0 [00:31<00:23, 4427.66it/s]     55%|#####5    | 129746/234119.0 [00:31<00:23, 4399.94it/s]     56%|#####5    | 130187/234119.0 [00:31<00:23, 4374.20it/s]     56%|#####5    | 130625/234119.0 [00:31<00:23, 4365.04it/s]     56%|#####5    | 131062/234119.0 [00:31<00:24, 4225.02it/s]     56%|#####6    | 131498/234119.0 [00:31<00:24, 4263.45it/s]     56%|#####6    | 131927/234119.0 [00:32<00:23, 4269.72it/s]     57%|#####6    | 132355/234119.0 [00:32<00:24, 4230.06it/s]     57%|#####6    | 132790/234119.0 [00:32<00:23, 4264.55it/s]     57%|#####6    | 133217/234119.0 [00:32<00:23, 4247.70it/s]     57%|#####7    | 133659/234119.0 [00:32<00:23, 4298.62it/s]     57%|#####7    | 134100/234119.0 [00:32<00:23, 4329.40it/s]     57%|#####7    | 134552/234119.0 [00:32<00:22, 4383.16it/s]     58%|#####7    | 134991/234119.0 [00:32<00:22, 4369.62it/s]     58%|#####7    | 135429/234119.0 [00:32<00:22, 4317.75it/s]     58%|#####8    | 135861/234119.0 [00:32<00:22, 4279.74it/s]     58%|#####8    | 136290/234119.0 [00:33<00:23, 4237.80it/s]     58%|#####8    | 136715/234119.0 [00:33<00:22, 4240.15it/s]     59%|#####8    | 137158/234119.0 [00:33<00:22, 4294.53it/s]     59%|#####8    | 137601/234119.0 [00:33<00:22, 4334.67it/s]     59%|#####8    | 138038/234119.0 [00:33<00:22, 4344.44it/s]     59%|#####9    | 138477/234119.0 [00:33<00:21, 4354.64it/s]     59%|#####9    | 138927/234119.0 [00:33<00:21, 4396.31it/s]     60%|#####9    | 139367/234119.0 [00:33<00:22, 4230.09it/s]     60%|#####9    | 139792/234119.0 [00:33<00:22, 4177.99it/s]     60%|#####9    | 140217/234119.0 [00:33<00:22, 4197.48it/s]     60%|######    | 140651/234119.0 [00:34<00:22, 4238.07it/s]     60%|######    | 141092/234119.0 [00:34<00:21, 4287.40it/s]     60%|######    | 141534/234119.0 [00:34<00:21, 4326.36it/s]     61%|######    | 141984/234119.0 [00:34<00:21, 4376.71it/s]     61%|######    | 142427/234119.0 [00:34<00:20, 4391.08it/s]     61%|######1   | 142882/234119.0 [00:34<00:20, 4437.93it/s]     61%|######1   | 143326/234119.0 [00:34<00:20, 4424.49it/s]     61%|######1   | 143773/234119.0 [00:34<00:20, 4435.33it/s]     62%|######1   | 144217/234119.0 [00:34<00:20, 4363.52it/s]     62%|######1   | 144654/234119.0 [00:34<00:20, 4297.60it/s]     62%|######1   | 145099/234119.0 [00:35<00:20, 4340.85it/s]     62%|######2   | 145534/234119.0 [00:35<00:20, 4291.59it/s]     62%|######2   | 145964/234119.0 [00:35<00:20, 4290.20it/s]     63%|######2   | 146398/234119.0 [00:35<00:20, 4302.16it/s]     63%|######2   | 146845/234119.0 [00:35<00:20, 4350.02it/s]     63%|######2   | 147309/234119.0 [00:35<00:19, 4434.45it/s]     63%|######3   | 147763/234119.0 [00:35<00:19, 4465.92it/s]     63%|######3   | 148210/234119.0 [00:35<00:19, 4455.58it/s]     63%|######3   | 148656/234119.0 [00:35<00:19, 4378.20it/s]     64%|######3   | 149095/234119.0 [00:36<00:19, 4327.82it/s]     64%|######3   | 149543/234119.0 [00:36<00:19, 4369.73it/s]     64%|######4   | 150004/234119.0 [00:36<00:18, 4439.63it/s]     64%|######4   | 150455/234119.0 [00:36<00:18, 4459.06it/s]     64%|######4   | 150905/234119.0 [00:36<00:18, 4470.01it/s]     65%|######4   | 151353/234119.0 [00:36<00:18, 4463.25it/s]     65%|######4   | 151801/234119.0 [00:36<00:18, 4466.54it/s]     65%|######5   | 152263/234119.0 [00:36<00:18, 4509.81it/s]     65%|######5   | 152723/234119.0 [00:36<00:17, 4535.45it/s]     65%|######5   | 153177/234119.0 [00:36<00:18, 4495.22it/s]     66%|######5   | 153627/234119.0 [00:37<00:18, 4459.30it/s]     66%|######5   | 154101/234119.0 [00:37<00:17, 4540.62it/s]     66%|######6   | 154556/234119.0 [00:37<00:17, 4494.16it/s]     66%|######6   | 155006/234119.0 [00:37<00:17, 4430.13it/s]     66%|######6   | 155454/234119.0 [00:37<00:17, 4442.90it/s]     67%|######6   | 155908/234119.0 [00:37<00:17, 4470.21it/s]     67%|######6   | 156356/234119.0 [00:37<00:17, 4422.17it/s]     67%|######6   | 156803/234119.0 [00:37<00:17, 4434.96it/s]     67%|######7   | 157247/234119.0 [00:37<00:17, 4325.58it/s]     67%|######7   | 157681/234119.0 [00:37<00:17, 4313.75it/s]     68%|######7   | 158131/234119.0 [00:38<00:17, 4367.88it/s]     68%|######7   | 158589/234119.0 [00:38<00:17, 4428.58it/s]     68%|######7   | 159033/234119.0 [00:38<00:17, 4407.90it/s]     68%|######8   | 159492/234119.0 [00:38<00:16, 4461.54it/s]     68%|######8   | 159948/234119.0 [00:38<00:16, 4490.50it/s]     69%|######8   | 160398/234119.0 [00:38<00:16, 4457.75it/s]     69%|######8   | 160854/234119.0 [00:38<00:16, 4485.98it/s]     69%|######8   | 161317/234119.0 [00:38<00:16, 4526.48it/s]     69%|######9   | 161770/234119.0 [00:38<00:16, 4476.97it/s]     69%|######9   | 162218/234119.0 [00:38<00:16, 4408.85it/s]     69%|######9   | 162660/234119.0 [00:39<00:16, 4402.28it/s]     70%|######9   | 163115/234119.0 [00:39<00:15, 4444.01it/s]     70%|######9   | 163560/234119.0 [00:39<00:15, 4437.80it/s]     70%|#######   | 164018/234119.0 [00:39<00:15, 4478.54it/s]     70%|#######   | 164470/234119.0 [00:39<00:15, 4488.54it/s]     70%|#######   | 164919/234119.0 [00:39<00:15, 4487.61it/s]     71%|#######   | 165380/234119.0 [00:39<00:15, 4523.58it/s]     71%|#######   | 165835/234119.0 [00:39<00:15, 4531.18it/s]     71%|#######1  | 166289/234119.0 [00:39<00:15, 4363.30it/s]     71%|#######1  | 166730/234119.0 [00:39<00:15, 4376.78it/s]     71%|#######1  | 167169/234119.0 [00:40<00:15, 4362.00it/s]     72%|#######1  | 167624/234119.0 [00:40<00:15, 4415.21it/s]     72%|#######1  | 168087/234119.0 [00:40<00:14, 4478.54it/s]     72%|#######1  | 168541/234119.0 [00:40<00:14, 4494.73it/s]     72%|#######2  | 168992/234119.0 [00:40<00:14, 4497.47it/s]     72%|#######2  | 169459/234119.0 [00:40<00:14, 4547.67it/s]     73%|#######2  | 169929/234119.0 [00:40<00:13, 4592.91it/s]     73%|#######2  | 170389/234119.0 [00:40<00:13, 4553.35it/s]     73%|#######2  | 170845/234119.0 [00:40<00:14, 4510.87it/s]     73%|#######3  | 171297/234119.0 [00:40<00:14, 4471.33it/s]     73%|#######3  | 171745/234119.0 [00:41<00:14, 4335.89it/s]     74%|#######3  | 172181/234119.0 [00:41<00:14, 4340.40it/s]     74%|#######3  | 172644/234119.0 [00:41<00:13, 4423.65it/s]     74%|#######3  | 173100/234119.0 [00:41<00:13, 4463.81it/s]     74%|#######4  | 173557/234119.0 [00:41<00:13, 4494.30it/s]     74%|#######4  | 174014/234119.0 [00:41<00:13, 4513.87it/s]     75%|#######4  | 174466/234119.0 [00:41<00:13, 4465.77it/s]     75%|#######4  | 174913/234119.0 [00:41<00:13, 4382.41it/s]     75%|#######4  | 175352/234119.0 [00:41<00:13, 4354.18it/s]     75%|#######5  | 175803/234119.0 [00:41<00:13, 4399.58it/s]     75%|#######5  | 176244/234119.0 [00:42<00:13, 4399.10it/s]     75%|#######5  | 176685/234119.0 [00:42<00:13, 4381.35it/s]     76%|#######5  | 177140/234119.0 [00:42<00:12, 4429.73it/s]     76%|#######5  | 177598/234119.0 [00:42<00:12, 4471.78it/s]     76%|#######6  | 178049/234119.0 [00:42<00:12, 4482.44it/s]     76%|#######6  | 178498/234119.0 [00:42<00:12, 4456.85it/s]     76%|#######6  | 178944/234119.0 [00:42<00:12, 4397.17it/s]     77%|#######6  | 179395/234119.0 [00:42<00:12, 4429.27it/s]     77%|#######6  | 179841/234119.0 [00:42<00:12, 4434.52it/s]     77%|#######7  | 180285/234119.0 [00:43<00:12, 4380.88it/s]     77%|#######7  | 180736/234119.0 [00:43<00:12, 4418.61it/s]     77%|#######7  | 181193/234119.0 [00:43<00:11, 4459.16it/s]     78%|#######7  | 181649/234119.0 [00:43<00:11, 4487.40it/s]     78%|#######7  | 182109/234119.0 [00:43<00:11, 4520.95it/s]     78%|#######7  | 182562/234119.0 [00:43<00:11, 4446.94it/s]     78%|#######8  | 183008/234119.0 [00:43<00:11, 4392.77it/s]     78%|#######8  | 183448/234119.0 [00:43<00:11, 4306.93it/s]     79%|#######8  | 183880/234119.0 [00:43<00:11, 4220.43it/s]     79%|#######8  | 184303/234119.0 [00:43<00:11, 4216.70it/s]     79%|#######8  | 184732/234119.0 [00:44<00:11, 4233.74it/s]     79%|#######9  | 185188/234119.0 [00:44<00:11, 4328.78it/s]     79%|#######9  | 185629/234119.0 [00:44<00:11, 4351.61it/s]     79%|#######9  | 186070/234119.0 [00:44<00:11, 4365.55it/s]     80%|#######9  | 186519/234119.0 [00:44<00:10, 4401.61it/s]     80%|#######9  | 186960/234119.0 [00:44<00:10, 4364.11it/s]     80%|########  | 187398/234119.0 [00:44<00:10, 4366.63it/s]     80%|########  | 187842/234119.0 [00:44<00:10, 4387.45it/s]     80%|########  | 188281/234119.0 [00:44<00:10, 4385.07it/s]     81%|########  | 188726/234119.0 [00:44<00:10, 4404.05it/s]     81%|########  | 189175/234119.0 [00:45<00:10, 4427.30it/s]     81%|########  | 189618/234119.0 [00:45<00:10, 4416.67it/s]     81%|########1 | 190060/234119.0 [00:45<00:10, 4385.86it/s]     81%|########1 | 190499/234119.0 [00:45<00:09, 4372.59it/s]     82%|########1 | 190937/234119.0 [00:45<00:09, 4370.09it/s]     82%|########1 | 191375/234119.0 [00:45<00:09, 4363.01it/s]     82%|########1 | 191814/234119.0 [00:45<00:09, 4370.65it/s]     82%|########2 | 192258/234119.0 [00:45<00:09, 4390.26it/s]     82%|########2 | 192698/234119.0 [00:45<00:09, 4351.33it/s]     82%|########2 | 193146/234119.0 [00:45<00:09, 4386.75it/s]     83%|########2 | 193590/234119.0 [00:46<00:09, 4399.77it/s]     83%|########2 | 194035/234119.0 [00:46<00:09, 4411.79it/s]     83%|########3 | 194487/234119.0 [00:46<00:08, 4443.88it/s]     83%|########3 | 194932/234119.0 [00:46<00:08, 4415.21it/s]     83%|########3 | 195379/234119.0 [00:46<00:08, 4427.53it/s]     84%|########3 | 195822/234119.0 [00:46<00:08, 4416.14it/s]     84%|########3 | 196264/234119.0 [00:46<00:08, 4415.39it/s]     84%|########4 | 196706/234119.0 [00:46<00:08, 4400.09it/s]     84%|########4 | 197147/234119.0 [00:46<00:08, 4362.72it/s]     84%|########4 | 197584/234119.0 [00:46<00:08, 4364.81it/s]     85%|########4 | 198021/234119.0 [00:47<00:08, 4343.40it/s]     85%|########4 | 198456/234119.0 [00:47<00:08, 4234.64it/s]     85%|########4 | 198881/234119.0 [00:47<00:08, 4225.03it/s]     85%|########5 | 199304/234119.0 [00:47<00:08, 4203.40it/s]     85%|########5 | 199756/234119.0 [00:47<00:07, 4296.48it/s]     86%|########5 | 200186/234119.0 [00:47<00:07, 4252.22it/s]     86%|########5 | 200620/234119.0 [00:47<00:07, 4274.49it/s]     86%|########5 | 201055/234119.0 [00:47<00:07, 4295.24it/s]     86%|########6 | 201485/234119.0 [00:47<00:07, 4262.02it/s]     86%|########6 | 201912/234119.0 [00:47<00:07, 4255.82it/s]     86%|########6 | 202338/234119.0 [00:48<00:07, 4247.45it/s]     87%|########6 | 202763/234119.0 [00:48<00:07, 4220.44it/s]     87%|########6 | 203218/234119.0 [00:48<00:07, 4317.85it/s]     87%|########6 | 203662/234119.0 [00:48<00:06, 4352.75it/s]     87%|########7 | 204101/234119.0 [00:48<00:06, 4363.17it/s]     87%|########7 | 204546/234119.0 [00:48<00:06, 4387.31it/s]     88%|########7 | 204995/234119.0 [00:48<00:06, 4415.85it/s]     88%|########7 | 205437/234119.0 [00:48<00:06, 4369.71it/s]     88%|########7 | 205885/234119.0 [00:48<00:06, 4400.30it/s]     88%|########8 | 206334/234119.0 [00:48<00:06, 4426.33it/s]     88%|########8 | 206779/234119.0 [00:49<00:06, 4432.56it/s]     89%|########8 | 207231/234119.0 [00:49<00:06, 4458.58it/s]     89%|########8 | 207677/234119.0 [00:49<00:05, 4457.93it/s]     89%|########8 | 208125/234119.0 [00:49<00:05, 4464.07it/s]     89%|########9 | 208572/234119.0 [00:49<00:05, 4427.77it/s]     89%|########9 | 209015/234119.0 [00:49<00:05, 4339.89it/s]     89%|########9 | 209450/234119.0 [00:49<00:05, 4329.09it/s]     90%|########9 | 209884/234119.0 [00:49<00:05, 4314.98it/s]     90%|########9 | 210328/234119.0 [00:49<00:05, 4349.78it/s]     90%|######### | 210775/234119.0 [00:49<00:05, 4385.36it/s]     90%|######### | 211214/234119.0 [00:50<00:05, 4367.95it/s]     90%|######### | 211654/234119.0 [00:50<00:05, 4374.80it/s]     91%|######### | 212092/234119.0 [00:50<00:05, 4323.38it/s]     91%|######### | 212539/234119.0 [00:50<00:04, 4365.32it/s]     91%|######### | 212985/234119.0 [00:50<00:04, 4391.16it/s]     91%|#########1| 213432/234119.0 [00:50<00:04, 4413.30it/s]     91%|#########1| 213881/234119.0 [00:50<00:04, 4434.65it/s]     92%|#########1| 214325/234119.0 [00:50<00:04, 4414.90it/s]     92%|#########1| 214767/234119.0 [00:50<00:04, 4411.67it/s]     92%|#########1| 215209/234119.0 [00:51<00:04, 4326.64it/s]     92%|#########2| 215643/234119.0 [00:51<00:04, 4325.23it/s]     92%|#########2| 216091/234119.0 [00:51<00:04, 4369.68it/s]     92%|#########2| 216530/234119.0 [00:51<00:04, 4374.11it/s]     93%|#########2| 216976/234119.0 [00:51<00:03, 4397.85it/s]     93%|#########2| 217416/234119.0 [00:51<00:03, 4380.45it/s]     93%|#########3| 217855/234119.0 [00:51<00:03, 4316.46it/s]     93%|#########3| 218302/234119.0 [00:51<00:03, 4360.05it/s]     93%|#########3| 218739/234119.0 [00:51<00:03, 4326.06it/s]     94%|#########3| 219172/234119.0 [00:51<00:03, 4311.21it/s]     94%|#########3| 219614/234119.0 [00:52<00:03, 4342.75it/s]     94%|#########3| 220052/234119.0 [00:52<00:03, 4352.67it/s]     94%|#########4| 220488/234119.0 [00:52<00:03, 4286.37it/s]     94%|#########4| 220935/234119.0 [00:52<00:03, 4339.91it/s]     95%|#########4| 221372/234119.0 [00:52<00:02, 4347.55it/s]     95%|#########4| 221807/234119.0 [00:52<00:02, 4270.37it/s]     95%|#########4| 222237/234119.0 [00:52<00:02, 4277.41it/s]     95%|#########5| 222666/234119.0 [00:52<00:04, 2443.36it/s]     95%|#########5| 223086/234119.0 [00:53<00:03, 2784.96it/s]     95%|#########5| 223516/234119.0 [00:53<00:03, 3113.21it/s]     96%|#########5| 223942/234119.0 [00:53<00:03, 3383.52it/s]     96%|#########5| 224372/234119.0 [00:53<00:02, 3614.13it/s]     96%|#########6| 224810/234119.0 [00:53<00:02, 3815.00it/s]     96%|#########6| 225227/234119.0 [00:53<00:02, 3909.31it/s]     96%|#########6| 225643/234119.0 [00:53<00:02, 3963.19it/s]     97%|#########6| 226057/234119.0 [00:53<00:02, 3914.66it/s]     97%|#########6| 226473/234119.0 [00:53<00:01, 3983.95it/s]     97%|#########6| 226884/234119.0 [00:54<00:01, 4020.13it/s]     97%|#########7| 227320/234119.0 [00:54<00:01, 4117.36it/s]     97%|#########7| 227745/234119.0 [00:54<00:01, 4155.33it/s]     97%|#########7| 228164/234119.0 [00:54<00:01, 4155.27it/s]     98%|#########7| 228590/234119.0 [00:54<00:01, 4184.22it/s]     98%|#########7| 229011/234119.0 [00:54<00:01, 4131.40it/s]     98%|#########7| 229426/234119.0 [00:54<00:01, 4078.95it/s]     98%|#########8| 229848/234119.0 [00:54<00:01, 4119.20it/s]     98%|#########8| 230277/234119.0 [00:54<00:00, 4168.23it/s]     99%|#########8| 230695/234119.0 [00:54<00:00, 4168.26it/s]     99%|#########8| 231115/234119.0 [00:55<00:00, 4173.60it/s]     99%|#########8| 231533/234119.0 [00:55<00:00, 4168.37it/s]     99%|#########9| 231957/234119.0 [00:55<00:00, 4187.91it/s]     99%|#########9| 232376/234119.0 [00:55<00:00, 4161.64it/s]     99%|#########9| 232813/234119.0 [00:55<00:00, 4220.32it/s]    100%|#########9| 233241/234119.0 [00:55<00:00, 4236.00it/s]    100%|#########9| 233688/234119.0 [00:55<00:00, 4304.31it/s]    100%|##########| 234119/234119.0 [00:55<00:00, 4179.25it/s]    100%|##########| 234119/234119.0 [00:55<00:00, 4195.44it/s]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
    Optimizing level 2 [max iter: 10000]
    Optimizing level 1 [max iter: 1000]
    Optimizing level 0 [max iter: 100]
      0%|          | 0/28181 [00:00<?, ?it/s]      0%|          | 2/28181 [00:00<28:50, 16.29it/s]      0%|          | 4/28181 [00:06<13:45:04,  1.76s/it]      0%|          | 20/28181 [00:06<1:49:19,  4.29it/s]      4%|3         | 1040/28181 [00:06<01:21, 333.19it/s]     11%|#         | 3088/28181 [00:06<00:20, 1214.02it/s]     22%|##1       | 6160/28181 [00:06<00:07, 2841.58it/s]     29%|##9       | 8208/28181 [00:06<00:05, 3968.95it/s]     36%|###6      | 10256/28181 [00:06<00:03, 5250.88it/s]     44%|####3     | 12304/28181 [00:06<00:02, 6442.87it/s]     51%|#####     | 14352/28181 [00:07<00:01, 7680.36it/s]     58%|#####8    | 16400/28181 [00:07<00:01, 8397.85it/s]     65%|######5   | 18448/28181 [00:07<00:01, 6647.14it/s]     73%|#######2  | 20496/28181 [00:08<00:01, 4647.40it/s]     80%|#######9  | 22544/28181 [00:10<00:02, 2462.16it/s]     87%|########7 | 24592/28181 [00:11<00:01, 1855.47it/s]     95%|#########4| 26640/28181 [00:14<00:01, 1399.90it/s]     96%|#########5| 26976/28181 [00:15<00:01, 1009.38it/s]     97%|#########6| 27312/28181 [00:16<00:00, 964.61it/s]      98%|#########8| 27648/28181 [00:16<00:00, 906.18it/s]    100%|##########| 28181/28181 [00:17<00:00, 1652.87it/s]
      0%|          | 0/28181 [00:00<?, ?it/s]      0%|          | 28/28181 [00:00<01:52, 250.15it/s]      1%|          | 188/28181 [00:00<00:30, 904.55it/s]      2%|1         | 508/28181 [00:00<00:21, 1260.43it/s]      3%|2         | 764/28181 [00:00<00:18, 1506.90it/s]      4%|3         | 1020/28181 [00:00<00:16, 1677.81it/s]      5%|4         | 1276/28181 [00:00<00:19, 1403.39it/s]      5%|5         | 1532/28181 [00:01<00:19, 1340.91it/s]      6%|6         | 1788/28181 [00:01<00:20, 1312.50it/s]      7%|7         | 2044/28181 [00:01<00:19, 1356.73it/s]      8%|8         | 2300/28181 [00:01<00:19, 1302.63it/s]     10%|9         | 2812/28181 [00:01<00:12, 1978.94it/s]     11%|#         | 3068/28181 [00:02<00:13, 1828.73it/s]     12%|#1        | 3324/28181 [00:02<00:13, 1870.92it/s]     13%|#2        | 3580/28181 [00:02<00:14, 1640.30it/s]     14%|#3        | 3836/28181 [00:02<00:20, 1168.12it/s]     15%|#4        | 4092/28181 [00:02<00:20, 1200.83it/s]     15%|#5        | 4348/28181 [00:03<00:18, 1261.41it/s]     16%|#6        | 4604/28181 [00:03<00:17, 1343.38it/s]     17%|#7        | 4860/28181 [00:03<00:18, 1291.36it/s]     18%|#8        | 5116/28181 [00:03<00:20, 1113.61it/s]     19%|#9        | 5372/28181 [00:04<00:23, 974.43it/s]      20%|#9        | 5628/28181 [00:04<00:19, 1134.84it/s]     21%|##        | 5884/28181 [00:04<00:19, 1138.50it/s]     22%|##1       | 6140/28181 [00:04<00:20, 1053.48it/s]     23%|##2       | 6396/28181 [00:05<00:25, 855.57it/s]      24%|##3       | 6652/28181 [00:05<00:22, 943.70it/s]     25%|##4       | 6908/28181 [00:05<00:18, 1160.61it/s]     25%|##5       | 7164/28181 [00:05<00:17, 1185.86it/s]     26%|##6       | 7420/28181 [00:06<00:22, 940.77it/s]      27%|##7       | 7676/28181 [00:06<00:20, 995.77it/s]     28%|##8       | 7932/28181 [00:06<00:18, 1096.79it/s]     29%|##9       | 8188/28181 [00:06<00:21, 950.48it/s]      30%|##9       | 8444/28181 [00:07<00:23, 837.53it/s]     31%|###       | 8700/28181 [00:07<00:22, 855.66it/s]     32%|###1      | 8956/28181 [00:07<00:18, 1039.25it/s]     33%|###2      | 9212/28181 [00:08<00:21, 902.37it/s]      34%|###3      | 9468/28181 [00:08<00:19, 946.97it/s]     35%|###4      | 9724/28181 [00:08<00:20, 918.88it/s]     35%|###5      | 9980/28181 [00:08<00:22, 821.22it/s]     36%|###6      | 10236/28181 [00:09<00:22, 796.53it/s]     38%|###8      | 10748/28181 [00:09<00:18, 966.54it/s]     39%|###9      | 11004/28181 [00:10<00:18, 947.59it/s]     40%|###9      | 11260/28181 [00:10<00:18, 911.72it/s]     41%|####      | 11516/28181 [00:10<00:16, 985.68it/s]     42%|####1     | 11772/28181 [00:10<00:13, 1188.93it/s]     43%|####2     | 12028/28181 [00:10<00:15, 1067.85it/s]     44%|####3     | 12284/28181 [00:11<00:16, 973.89it/s]      45%|####5     | 12796/28181 [00:11<00:11, 1314.61it/s]     46%|####6     | 13052/28181 [00:11<00:11, 1304.49it/s]     48%|####8     | 13564/28181 [00:11<00:08, 1646.06it/s]     50%|####9     | 14076/28181 [00:11<00:06, 2083.70it/s]     54%|#####4    | 15356/28181 [00:12<00:03, 3796.20it/s]     62%|######1   | 17404/28181 [00:12<00:01, 6966.96it/s]     76%|#######6  | 21500/28181 [00:12<00:00, 11421.14it/s]     84%|########3 | 23548/28181 [00:12<00:00, 12370.70it/s]     91%|######### | 25596/28181 [00:12<00:00, 11881.26it/s]     98%|#########8| 27644/28181 [00:12<00:00, 11494.20it/s]    100%|##########| 28181/28181 [00:12<00:00, 2175.29it/s] 
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  3.83it/s]    100%|##########| 2/2 [00:00<00:00,  4.36it/s]    100%|##########| 2/2 [00:00<00:00,  4.27it/s]
      0%|          | 0/2 [00:00<?, ?it/s]     50%|#####     | 1/2 [00:00<00:00,  4.53it/s]    100%|##########| 2/2 [00:00<00:00,  4.64it/s]    100%|##########| 2/2 [00:00<00:00,  4.62it/s]




.. GENERATED FROM PYTHON SOURCE LINES 135-146

Visualize a montage
----------------------
One way to examine the output of the pyAFQ pipeline is by creating a montage
of images of a particular bundle across a group of participants (or, in this
case, the one participant that was analyzed).

.. note::

  The montage file is copied to the present working directory so that it gets
  properly rendered into the web-page containing this example. It is not
  necessary to do this when running this type of analysis.

.. GENERATED FROM PYTHON SOURCE LINES 146-151

.. code-block:: default


    my_afq.combine_bundle("L_OR")
    montage = my_afq.montage("L_OR", (1, 1), "Axial")
    shutil.copy(montage[0], op.split(montage[0])[-1])




.. image-sg:: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :alt: plot optic radiations
   :srcset: /auto_examples/images/sphx_glr_plot_optic_radiations_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:00<00:00, 11.47it/s]
      0%|          | 0/1 [00:00<?, ?it/s]    100%|##########| 1/1 [00:04<00:00,  4.75s/it]    100%|##########| 1/1 [00:04<00:00,  4.75s/it]

    'bundle-L_OR_view-Axial_idx-0_montage.png'



.. GENERATED FROM PYTHON SOURCE LINES 152-158

Interactive bundle visualization
--------------------------------
Another way to examine the outputs is to export the individual bundle
figures, which show the streamlines, as well as the ROIs used to define the
bundle. This is an html file, which contains an interactive figure that can
be navigated, zoomed, rotated, etc.

.. GENERATED FROM PYTHON SOURCE LINES 158-162

.. code-block:: default


    bundle_html = my_afq.export("indiv_bundles_figures")
    plotly.io.show(bundle_html["NDARAA948VFH"]["L_OR"])




.. raw:: html
    :file: images/sphx_glr_plot_optic_radiations_002.html





.. GENERATED FROM PYTHON SOURCE LINES 163-186

References
----------
.. [1] Caffarra S, Joo SJ, Bloom D, Kruper J, Rokem A, Yeatman JD. Development
    of the visual white matter pathways mediates development of
    electrophysiological responses in visual cortex. Hum Brain Mapp.
    2021;42(17):5785-5797.

.. [2] Caffarra S, Kanopka K, Kruper J, Richie-Halford A, Roy E, Rokem A,
    Yeatman JD. Development of the alpha rhythm is linked to visual white
    matter pathways and visual detection performance. bioRxiv.
    doi:10.1101/2022.09.03.506461

.. [3] Alexander LM, Escalera J, Ai L, et al. An open resource for
    transdiagnostic research in pediatric mental health and learning
    disorders. Sci Data. 2017;4:170181.

.. [4] Richie-Halford A, Cieslak M, Ai L, et al. An analysis-ready and quality
    controlled resource for pediatric brain white-matter research. Scientific
    Data. 2022;9(1):1-27.

.. [5] Cieslak M, Cook PA, He X, et al. QSIPrep: an integrative platform for
    preprocessing and reconstructing diffusion MRI data. Nat Methods.
    2021;18(7):775-778.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 23 minutes  20.542 seconds)


.. _sphx_glr_download_auto_examples_plot_optic_radiations.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_optic_radiations.py <plot_optic_radiations.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_optic_radiations.ipynb <plot_optic_radiations.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
